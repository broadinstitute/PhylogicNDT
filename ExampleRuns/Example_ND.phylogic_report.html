<!DOCTYPE html>
<html lang="en">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<head>
  <title>Example_ND Phylogic Report</title>
  <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  <script src="https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
  <script src="https://d3js.org/d3.v5.js"></script>
  <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.sample_name_table", {

        options: {
          columns: [],
          sample_names: [],
          sample_aliases: [],
          sample_dates: [],
          pie_plots: []
        },


        _create: function() {
          let columns = this.options.columns;

          let table = d3.select(this.element.context).append("table")
            .attr("class", "table table-bordered hover");

          table.append("thead")
            .selectAll("td")
            .data(columns)
            .join("td")
            .attr("style", "font-weight:bold; font-size: 12px")
            .html(d => d);

          table.append("tbody")
            .selectAll("tr")
            .data(this.options.sample_names)
            .join("tr")
            .attr("style", "font-size: 12px; cursor: pointer;")
            .attr("class", "active-sample")
            .attr("onclick", "$(\"#sample-name-table\").sample_name_table(\"toggle_sample\", this)")
            .html((d, i) => "<td>" + d + "</td>"
              + (this.options.sample_aliases.length ? "<td>" + this.options.sample_aliases[i] + "</td>" : "")
              + (this.options.sample_dates.length ? "<td>" + this.options.sample_dates[i] + "</td>" : "")
              + "<td><img src=data:image/png;base64," + this.options.pie_plots[i] + " alt=\"Run BuildTree to display\"></td>");

        },

        toggle_sample: function(row) {
          if (row.className === "active-sample") {
            row.className = "removed-sample";
          } else {
            row.className = "active-sample"
          }
        }

      });

      $("#sample-name-table").sample_name_table({"sample_aliases": ["T0", "T1", "T2", "T3"], "pie_plots": ["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"], "sample_names": ["sample_00", "sample_01", "sample_02", "sample_03"], "sample_dates": [0.0, 1.0, 2.0, 3.0], "columns": ["Sample Name", "Alias", "Date", "Clonal Abundance"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.clustering_plot", {

        options: {
          xlabels: [],
          time_points: [],
          cluster_dict: {},
          width: 500,
          height: 400,
          margins: {top: 20, right: 50, bottom: 35, left: 50}
        },

        _elements: {
          nd: undefined,
          real_time: undefined,
          scaled: undefined,
          time_agnostic_plot: undefined,
          time_scaled_plot: undefined,
          plot_1d: undefined,
          t: undefined,
          n: undefined,
          y: undefined
        },

        _create: function() {
          let xlabels = this.options.xlabels,
            time_points = this.options.time_points,
            cluster_dict = this.options.cluster_dict,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins,
            n_samples = xlabels.length,
            unscaled_x = [...Array(n_samples).keys()];

          this._elements.nd = xlabels.length > 1;
          this._elements.real_time = time_points.reduce((a, c, i) => a || !(c===i), false);
          this._elements.scaled = this._elements.real_time;

          if (this._elements.nd) {
            let n = d3.scaleLinear()
              .domain([0, xlabels.length - 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, 1])
              .range([height - margins.bottom, margins.top]);

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let time_agnostic_plot = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
              .attr("overflow", "visible")
              .attr("onmousemove", "$(\"#clustering-plot\").clustering_plot(\"show_value\", event, this)")
              .attr("onmouseleave", "$(\"#clustering-plot\").clustering_plot(\"hide_value\", this)")
              .style("display", this._elements.real_time ? "none" : "block")
              .style("max-height", "450px");
            time_agnostic_plot.append("g")
              .call(g => g
                .attr("transform", "translate(0 " + (height - margins.bottom) + ")")
                .call(d3.axisBottom(n).tickValues(unscaled_x).tickFormat(d => xlabels[d]))
              );
            time_agnostic_plot.append("g")
              .call(yAxis);
            time_agnostic_plot.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Samples");
            time_agnostic_plot.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            for (let clust in cluster_dict) {
              time_agnostic_plot.append("path")
                .datum(unscaled_x)
                .attr("fill", "none")
                .attr("stroke", cluster_dict[clust].color)
                .attr("stroke-width", cluster_dict[clust].line_width)
                .attr("opacity", 0.5)
                .attr("d", d3.line()
                  .x(d => n(d))
                  .y(d => y(cluster_dict[clust].ccf_hat[d])));
              time_agnostic_plot.append("polygon")
                .attr("fill", cluster_dict[clust].color)
                .attr("stroke", "none")
                .attr("opacity", 0.2)
                .attr("points", cluster_dict[clust].ccf_high.reduce((a, c, i) => a + n(i) + "," + y(c) + " ", "") +
                  cluster_dict[clust].ccf_low.reverse().reduce((a, c, i) => a + n(n_samples - i - 1) + "," + y(c) + " ", "")
                );
              time_agnostic_plot.append("g").selectAll("circle")
                .data(unscaled_x)
                .join("circle")
                  .attr("fill", cluster_dict[clust].color)
                  .attr("stroke", "none")
                  .attr("r", 7)
                  .attr("opacity", 1.0)
                  .attr("cx", d => n(d))
                  .attr("cy", d => y(cluster_dict[clust].ccf_hat[d]))
            }
            time_agnostic_plot.append("g")
              .style("display", "none")
              .attr("class", "tooltip_");

            this._elements.n = n;
            this._elements.time_agnostic_plot = time_agnostic_plot.node();

            if (this._elements.real_time) {
              let t = d3.scaleLinear()
                .domain([Math.min(...time_points), Math.max(...time_points)])
                .range([margins.left, width - margins.right]);

              let time_scaled_plot = d3.select(document.createElement("svg"))
                .attr("baseProfile", "full")
                .attr("viewBox", "0 0 " + width + " " + height)
                .attr("version", "1.1")
                .attr("xmlns", "http://www.w3.org/2000/svg")
                .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
                .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
                .attr("overflow", "visible")
                .attr("onmousemove", "$(\"#clustering-plot\").clustering_plot(\"show_value\", event, this)")
                .attr("onmouseleave", "$(\"#clustering-plot\").clustering_plot(\"hide_value\", this)")
                .style("display", "block")
                .style("max-height", "450px");
              time_scaled_plot.append("g")
                .call(g => g
                  .attr("transform", "translate(0 " + (height - margins.bottom) + ")")
                  .call(d3.axisBottom(t))
                );
              time_scaled_plot.append("g")
                .call(yAxis);
              time_scaled_plot.append("text")
                .attr("x", (width + margins.left - margins.right) / 2)
                .attr("y", height - 5)
                .style("text-anchor", "middle")
                .attr("font-size", "10px")
                .text("Time");
              time_scaled_plot.append("text")
                .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
                .attr("x", 10)
                .attr("y", (height + margins.top - margins.bottom) / 2)
                .style("text-anchor", "middle")
                .attr("font-size", "10px")
                .text("CCF(x)");
              for (let clust in cluster_dict) {
                time_scaled_plot.append("path")
                  .datum(time_points)
                  .attr("fill", "none")
                  .attr("stroke", cluster_dict[clust].color)
                  .attr("stroke-width", cluster_dict[clust].line_width)
                  .attr("opacity", 0.5)
                  .attr("d", d3.line()
                    .x(d => t(d))
                    .y((d, i) => y(cluster_dict[clust].ccf_hat[i])));
                time_scaled_plot.append("polygon")
                  .attr("fill", cluster_dict[clust].color)
                  .attr("stroke", "none")
                  .attr("opacity", 0.2)
                  .attr("points", cluster_dict[clust].ccf_high.reduce((a, c, i) => a + t(time_points[i]) + "," + y(c) + " ", "") +
                    cluster_dict[clust].ccf_low.reduce((a, c, i) => a + t(time_points[n_samples - i - 1]) + "," + y(c) + " ", "")
                  );
                time_scaled_plot.append("g").selectAll("circle")
                  .data(time_points)
                  .join("circle")
                    .attr("fill", cluster_dict[clust].color)
                    .attr("stroke", "none")
                    .attr("r", 7)
                    .attr("opacity", 1.0)
                    .attr("cx", d => t(d))
                    .attr("cy", (d, i) => y(cluster_dict[clust].ccf_hat[i]))
              }
              time_scaled_plot.append("g")
                .style("display", "none")
                .attr("class", "tooltip_");
              
              this._elements.t = t;
              this._elements.time_scaled_plot = time_scaled_plot.node()
            }
            for (let clust in cluster_dict) {
              cluster_dict[clust].ccf_low.reverse();
            }
          } else {
            let max_bin = 0,
              n_bins;
            for (let c in cluster_dict) {
              max_bin = Math.max(max_bin, ...cluster_dict[c].ccf_dist);
              n_bins = cluster_dict[c].ccf_dist.length
            }
            let x = d3.scaleLinear()
              .domain([0, 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, max_bin]).nice()
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let plot_1d = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
              .attr("style", "max-height: 450px");
            plot_1d.append("g")
              .call(xAxis);
            plot_1d.append("g")
              .call(yAxis);
            plot_1d.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            plot_1d.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Probability density");

            let zero_str = Array(n_bins).fill(0).reduce(
              (a, c, i) => a + " " + x((n_bins - i - 1) / (n_bins - 1)).toString() + "," + y(0).toString(), " "
            );

            plot_1d.selectAll("polygon")
              .data(Object.keys(cluster_dict))
              .join("polygon")
              .attr("points", d =>
                cluster_dict[d].ccf_dist.reduce(
                  (a, c, i) => a + " " + x(i / (n_bins - 1)).toString() + "," + y(c).toString(), ""
                ) + zero_str
              )
              .attr("fill", d => cluster_dict[d].color)
              .attr("opacity", 0.5)
              .attr("stroke", "none");

            this._elements.plot_1d = plot_1d.node()
          }
          
          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.nd ?
            (this._elements.real_time ? this._elements.time_scaled_plot.outerHTML : "") + this._elements.time_agnostic_plot.outerHTML :
            this._elements.plot_1d.outerHTML;
        },

        switch_plot: function() {
          let display = this._elements.time_agnostic_plot.style.display === "none";
          this._elements.time_agnostic_plot.style.display = display ? "block" : "none";
          this._elements.time_scaled_plot.style.display = display ? "none" : "block";
          this._elements.scaled = !this._elements.scaled;

          this._refresh();
        },

        show_value: function(eve, plot) {
          let {width, height} = plot.getBoundingClientRect(),
            mouse_pos_x = eve.layerX * this.options.width / width,
            mouse_pos_y = eve.layerY * this.options.height / height,
            cluster_dict = this.options.cluster_dict,
            xlabels = this.options.xlabels,
            time_points = this.options.time_points,
            tooltip = d3.select(plot).select(".tooltip_"),
            x,
            n;

          if (this._elements.scaled) {
            let scale_x = this._elements.t,
              x_s = scale_x.invert(mouse_pos_x),
              t = time_points.reduce((a, c) => (Math.abs(c - x_s) < Math.abs(a - x_s) ? c : a));
            n = time_points.indexOf(t);
            x = scale_x(t);
          } else {
            let scale_x = this._elements.n;
            n = Math.round(scale_x.invert(mouse_pos_x));
            x = scale_x(n);
          }

          tooltip
            .attr("style", "display: block;")
            .attr("transform", "translate(" + x + "," + mouse_pos_y + ")");

          let border = tooltip.selectAll("path")
            .data([null])
            .join("path")
              .attr("fill", "white")
              .attr("stroke", "black");

          let text_el = tooltip.selectAll("text")
            .data([null])
            .attr("font-size", "9px")
            .join("text")
            .call(t => t
              .selectAll("tspan")
              .data([xlabels[n], ...Object.keys(cluster_dict)])
              .join("tspan")
                .attr("x", 0)
                .attr("y", (d, i) => (i * 1.1) + "em")
                .style("font-weight", (d, i) => i ? null : "bold")
                .style("fill", (d, i) => i ? cluster_dict[d].color : "black")
                .text((d, i) => i ? cluster_dict[d].ccf_hat[n] + " (" + cluster_dict[d].ccf_low[n] + "-" +
                  cluster_dict[d].ccf_high[n] + ")" : d)
            );

          let {y, width: w, height: h} = text_el.node().getBBox();

          text_el.attr("transform", "translate(" + (-w / 2) + "," + (15 - y) + ")");
          border.attr("d", "M" + (-w / 2 - 10) + ",5H-5l5,-5l5,5H" +
            (w / 2 + 10) + "v" + (h + 20) +
            "h-" + (w + 20) + "z");
        },

        hide_value: function(plot) {
          d3.select(plot).select(".tooltip_").style("display", "none")
        },

        download: function() {
          let dl_link;
          if (this._elements.scaled) {
            let time_scaled_plot = this._elements.time_scaled_plot.cloneNode(true);
            time_scaled_plot.removeAttribute("onmousemove");
            time_scaled_plot.removeAttribute("onmouseleave");
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(time_scaled_plot.outerHTML);
          } else if (this._elements.nd) {
            let time_agnostic_plot = this._elements.time_agnostic_plot.cloneNode(true);
            time_agnostic_plot.removeAttribute("onmousemove");
            time_agnostic_plot.removeAttribute("onmouseleave");
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(time_agnostic_plot.outerHTML);
          } else {
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.plot_1d.outerHTML);
          }
          let dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "Example_ND" + ".clustering_plot.svg");
          dl.click();
        },

        _destroy: function() {
          this.element.context.innerHTML = "";
        }

      });

      $("#clustering-plot").clustering_plot({"cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [0.98, 1.0, 0.92, 0.97], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"], "chrom": "chr1", "pos": "203116592"}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"], "chrom": "chr6", "pos": "54069115"}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"], "chrom": "chr6", "pos": "31180141"}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"], "chrom": "chr16", "pos": "12137783"}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"], "chrom": "chr4", "pos": "12358155"}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"], "chrom": "chr5", "pos": "39128627"}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"], "chrom": "chr6", "pos": "1417608"}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"], "chrom": "chr10", "pos": "44150814"}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"], "chrom": "chr14", "pos": "41194468"}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"], "chrom": "chr1", "pos": "83112457"}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"], "chrom": "chr7", "pos": "125483252"}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"], "chrom": "chr1", "pos": "132144794"}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"], "chrom": "chr6", "pos": "74165244"}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"], "chrom": "chr8", "pos": "23624864"}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"], "chrom": "chr11", "pos": "71847859"}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"], "chrom": "chr10", "pos": "2401524"}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"], "chrom": "chr2", "pos": "155758820"}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"], "chrom": "chr1", "pos": "216025272"}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"], "chrom": "chr9", "pos": "54906067"}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"], "chrom": "chr16", "pos": "4448042"}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"], "chrom": "chr11", "pos": "42572643"}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"], "chrom": "chr8", "pos": "68794502"}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"], "chrom": "chr2", "pos": "221118783"}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"], "chrom": "chr16", "pos": "60609731"}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"], "chrom": "chr11", "pos": "132617216"}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"], "chrom": "chr2", "pos": "134658375"}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"], "chrom": "chr11", "pos": "85707387"}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"], "chrom": "chr4", "pos": "37112458"}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"], "chrom": "chr20", "pos": "49921552"}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"], "chrom": "chr10", "pos": "86906761"}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"], "chrom": "chr12", "pos": "85192368"}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"], "chrom": "chr1", "pos": "26433505"}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"], "chrom": "chr17", "pos": "77961642"}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"], "chrom": "chr7", "pos": "23190612"}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"], "chrom": "chr18", "pos": "59256965"}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"], "chrom": "chr3", "pos": "7953112"}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"], "chrom": "chr1", "pos": "119718772"}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"], "chrom": "chr12", "pos": "51515436"}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"], "chrom": "chr15", "pos": "51641272"}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"], "chrom": "chr3", "pos": "177467084"}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"], "chrom": "chr2", "pos": "159443742"}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"], "chrom": "chr15", "pos": "9208331"}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"], "chrom": "chr8", "pos": "11016138"}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.96, 0.74, 0.01, 0.28], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"], "chrom": "chr4", "pos": "93217970"}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"], "chrom": "chr9", "pos": "109685447"}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"], "chrom": "chr8", "pos": "85404603"}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"], "chrom": "chr9", "pos": "26310976"}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"], "chrom": "chr12", "pos": "83082752"}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"], "chrom": "chr12", "pos": "59892443"}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"], "chrom": "chr15", "pos": "61601382"}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"], "chrom": "chr3", "pos": "112792751"}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"], "chrom": "chr2", "pos": "1276028"}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"], "chrom": "chr9", "pos": "5488020"}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"], "chrom": "chr2", "pos": "195739636"}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"], "chrom": "chr3", "pos": "4967308"}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"], "chrom": "chr18", "pos": "3791536"}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"], "chrom": "chr13", "pos": "43978569"}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"], "chrom": "chr20", "pos": "34878520"}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"], "chrom": "chr1", "pos": "192607152"}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"], "chrom": "chr1", "pos": "108730876"}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"], "chrom": "chr16", "pos": "83054051"}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"], "chrom": "chr7", "pos": "1739320"}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"], "chrom": "chr11", "pos": "81918530"}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.01, 0.09, 0.75, 0.03], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"], "chrom": "chr11", "pos": "72779563"}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr15", "pos": "74631626"}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"], "chrom": "chr11", "pos": "105419584"}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"], "chrom": "chr13", "pos": "31235332"}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"], "chrom": "chr15", "pos": "100671545"}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"], "chrom": "chr12", "pos": "10181887"}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"], "chrom": "chr8", "pos": "85536002"}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"], "chrom": "chr12", "pos": "89396230"}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"], "chrom": "chr2", "pos": "117890927"}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"], "chrom": "chr11", "pos": "77188078"}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"], "chrom": "chr4", "pos": "113590408"}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"], "chrom": "chr10", "pos": "15280573"}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"], "chrom": "chr9", "pos": "140287925"}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"], "chrom": "chr14", "pos": "83027451"}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"], "chrom": "chr17", "pos": "28217979"}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"], "chrom": "chr5", "pos": "107026837"}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"], "chrom": "chr17", "pos": "76824397"}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"], "chrom": "chr3", "pos": "194338870"}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"], "chrom": "chr5", "pos": "646819"}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"], "chrom": "chr8", "pos": "91541022"}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"], "chrom": "chr19", "pos": "12629303"}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"], "chrom": "chr4", "pos": "62487792"}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"], "chrom": "chr9", "pos": "65899379"}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"], "chrom": "chr6", "pos": "13811516"}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr2", "pos": "141016351"}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"], "chrom": "chr2", "pos": "63180458"}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"], "chrom": "chr3", "pos": "94346303"}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"], "chrom": "chr5", "pos": "18405277"}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"], "chrom": "chr2", "pos": "102011380"}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"], "chrom": "chr4", "pos": "28312378"}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"], "chrom": "chr18", "pos": "60319331"}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"], "chrom": "chr2", "pos": "98710565"}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.01, 0.04, 0.15, 0.66], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"], "chrom": "chr19", "pos": "28003645"}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"], "chrom": "chr10", "pos": "46572730"}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"], "chrom": "chr2", "pos": "187507667"}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"], "chrom": "chr2", "pos": "132632672"}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"], "chrom": "chr10", "pos": "74945835"}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"], "chrom": "chr4", "pos": "89478829"}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"], "chrom": "chr3", "pos": "129183914"}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"], "chrom": "chr19", "pos": "20753137"}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"], "chrom": "chr1", "pos": "155732526"}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"], "chrom": "chr6", "pos": "67586649"}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"], "chrom": "chr16", "pos": "28689827"}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"], "chrom": "chr18", "pos": "43153046"}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr8", "pos": "10234168"}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"], "chrom": "chr2", "pos": "178187360"}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"], "chrom": "chr9", "pos": "103609179"}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"], "chrom": "chr3", "pos": "118852316"}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"], "chrom": "chr12", "pos": "19536936"}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"], "chrom": "chr2", "pos": "154784087"}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"], "chrom": "chr2", "pos": "63896119"}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr15", "pos": "41548137"}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"], "chrom": "chr11", "pos": "134953622"}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"], "chrom": "chr4", "pos": "98907643"}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"], "chrom": "chr19", "pos": "52225547"}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"], "chrom": "chr5", "pos": "64764511"}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"], "chrom": "chr12", "pos": "26863967"}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr1", "pos": "152412016"}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"], "chrom": "chr5", "pos": "49140961"}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"], "chrom": "chr3", "pos": "133235099"}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"], "chrom": "chr3", "pos": "133203137"}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr11", "pos": "39857904"}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"], "chrom": "chr2", "pos": "6236611"}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"], "chrom": "chr7", "pos": "122826971"}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"], "chrom": "chr9", "pos": "132378857"}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"], "chrom": "chr1", "pos": "232770125"}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"], "chrom": "chr3", "pos": "182891000"}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"], "chrom": "chr3", "pos": "3079218"}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr15", "pos": "75412966"}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"], "chrom": "chr10", "pos": "113935377"}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"], "chrom": "chr4", "pos": "42944436"}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr10", "pos": "45446247"}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"], "chrom": "chr1", "pos": "219296486"}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"], "chrom": "chr6", "pos": "138504372"}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"], "chrom": "chr1", "pos": "105180724"}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr21", "pos": "44658727"}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"], "chrom": "chr1", "pos": "7333400"}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"], "chrom": "chr13", "pos": "101288184"}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"], "chrom": "chr18", "pos": "13213393"}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr1", "pos": "189508346"}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"], "chrom": "chr5", "pos": "105791975"}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"], "chrom": "chr19", "pos": "37085998"}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"], "chrom": "chr4", "pos": "13768761"}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"], "chrom": "chr5", "pos": "142128037"}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"], "chrom": "chr4", "pos": "109006791"}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"], "chrom": "chr10", "pos": "125649324"}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr1", "pos": "61872286"}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr11", "pos": "39379914"}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"], "chrom": "chr18", "pos": "37378724"}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"], "chrom": "chr5", "pos": "11911058"}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"], "chrom": "chr8", "pos": "131534148"}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"], "chrom": "chr19", "pos": "43375509"}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"], "chrom": "chr5", "pos": "82474821"}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"], "chrom": "chr17", "pos": "51719439"}}, "line_width": 12}}, "xlabels": ["T0", "T1", "T2", "T3"], "time_points": [0.0, 1.0, 2.0, 3.0]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.time_switch", {

        options: {show: true},

        _elements: {time_switch: undefined, input: undefined},

        _create: function() {
          if (this.options.show) {
            let time_switch = d3.select(document.createElement("label"))
              .html("Time-scaled");
            this._elements.input = time_switch.append("input")
              .attr("type", "checkbox")
              .attr("checked", "")
              .attr("onclick", "$(\"#time-switch\").time_switch(\"switch_plot\")")
              .node();

            this._elements.time_switch = time_switch.node();

            this._refresh()

          }
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.time_switch.outerHTML;
        },

        is_checked: function() {
          if (this.options.show) {
            return this._elements.input.hasAttribute("checked")
          }
          return true
        },

        switch_plot: function() {
          if (this.is_checked()) {
            this._elements.input.removeAttribute("checked");
          } else {
            this._elements.input.setAttribute("checked", "");
          }
          $("#clustering-plot").clustering_plot("switch_plot");

          this._refresh();
        }

      });

      $("#time-switch").time_switch({"show": false})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.cluster_switches", {
        options: {
          cluster_dict: {},
          time_points: [],
          xlabels: [],
          tumor_sizes: {},
          child_dict: {}
        },

        _elements: {
          active_clusters: [],
          svg_switches: undefined
        },

        _create: function() {
          let cluster_dict = this.options.cluster_dict,
            svg_layout = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
          for (let c in cluster_dict) {
            this._elements.active_clusters.push(c);
          }
          svg_layout.attr("viewBox", "0 0 120 " + ((this._elements.active_clusters.length + 2) * 30));
          svg_layout.selectAll("rect")
            .data(this._elements.active_clusters)
            .join("rect")
            .attr("class", "active-cluster")
            .attr("style", "cursor: pointer;")
            .attr("cluster", (_, i) => i + 1)
            .attr("x", 0)
            .attr("y", (_, i) => i * 30 + 30)
            .attr("width", 20)
            .attr("height", 20)
            .attr("fill", d => cluster_dict[d].color)
            .attr("stroke", "none")
            .attr("opacity", 0.8)
            .attr("onclick", "$(\"#cluster-switches\").cluster_switches(\"toggle_cluster\", this)");
          svg_layout.selectAll("text")
            .data(this._elements.active_clusters)
            .join("text")
            .attr("x", 30)
            .attr("y", (_, i) => i * 30 + 45)
            .attr("fill", d => cluster_dict[d].color)
            .text(d => d + " (" + Object.keys(cluster_dict[d].muts).length.toString() + ")");
          svg_layout.append("text")
            .attr("x", 0)
            .attr("y", 15)
            .attr("font-size", "11.5px")
            .text("Cluster (# variants)");

          this._elements.svg_switches = svg_layout.node();

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.svg_switches.outerHTML;
        },

        toggle_cluster: function(cluster_switch) {
          let c = cluster_switch.getAttribute("cluster"),
            cluster_dict = this.options.cluster_dict,
            child_dict = this.options.child_dict,
            active_clusters = this._elements.active_clusters,
            cluster_dict_subset = {},
            altered_child_dict = {};
          if (cluster_switch.getAttribute("class") === "active-cluster") {
            cluster_switch.setAttribute("class", "removed-cluster");
            for (let i in active_clusters) {
              if (active_clusters[i] === c) {
                active_clusters.splice(i, 1);
                break;
              }
            }
          } else {
            cluster_switch.setAttribute("class", "active-cluster");
            active_clusters.push(c);
          }

          let get_new_children = function(cluster) {
            let children = [];
            for (let i in child_dict[cluster]) {
              if (active_clusters.includes(child_dict[cluster][i].toString())) {
                children.push(child_dict[cluster][i])
              } else {
                children.push(...get_new_children(child_dict[cluster][i]))
              }
            }
            return children
          };

          for (let i in active_clusters) {
            let active_cluster = active_clusters[i];
            cluster_dict_subset[active_cluster] = cluster_dict[active_cluster];
            if (child_dict) {
              altered_child_dict[active_cluster] = get_new_children(active_cluster)
            }
          }
          if (child_dict) {
            altered_child_dict[null] = get_new_children(null);
          }

          let clustering_plot = $("#clustering-plot");
          clustering_plot.clustering_plot("destroy");
          clustering_plot.clustering_plot({
            xlabels: this.options.xlabels,
            time_points: this.options.time_points,
            cluster_dict: cluster_dict_subset});
          if (!$("#time-switch").time_switch("is_checked")) {
            clustering_plot.clustering_plot("switch_plot");
          }

          let mutation_plot = $("#mutation-plot");
          mutation_plot.mutation_plot("destroy");
          mutation_plot.mutation_plot({
            xlabels: this.options.xlabels,
            cluster_dict: cluster_dict_subset});

          if (child_dict) {
            let fish_plot = $("#fish-plot");
            fish_plot.fish_plot("destroy");
            fish_plot.fish_plot({
              xlabels: this.options.xlabels,
              time_points: this.options.time_points,
              tumor_sizes: this.options.tumor_sizes,
              cluster_dict: cluster_dict_subset,
              child_dict: altered_child_dict
            })
          }
        }
      });

      $("#cluster-switches").cluster_switches({"cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [0.98, 1.0, 0.92, 0.97], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"], "chrom": "chr1", "pos": "203116592"}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"], "chrom": "chr6", "pos": "54069115"}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"], "chrom": "chr6", "pos": "31180141"}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"], "chrom": "chr16", "pos": "12137783"}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"], "chrom": "chr4", "pos": "12358155"}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"], "chrom": "chr5", "pos": "39128627"}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"], "chrom": "chr6", "pos": "1417608"}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"], "chrom": "chr10", "pos": "44150814"}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"], "chrom": "chr14", "pos": "41194468"}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"], "chrom": "chr1", "pos": "83112457"}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"], "chrom": "chr7", "pos": "125483252"}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"], "chrom": "chr1", "pos": "132144794"}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"], "chrom": "chr6", "pos": "74165244"}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"], "chrom": "chr8", "pos": "23624864"}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"], "chrom": "chr11", "pos": "71847859"}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"], "chrom": "chr10", "pos": "2401524"}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"], "chrom": "chr2", "pos": "155758820"}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"], "chrom": "chr1", "pos": "216025272"}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"], "chrom": "chr9", "pos": "54906067"}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"], "chrom": "chr16", "pos": "4448042"}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"], "chrom": "chr11", "pos": "42572643"}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"], "chrom": "chr8", "pos": "68794502"}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"], "chrom": "chr2", "pos": "221118783"}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"], "chrom": "chr16", "pos": "60609731"}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"], "chrom": "chr11", "pos": "132617216"}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"], "chrom": "chr2", "pos": "134658375"}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"], "chrom": "chr11", "pos": "85707387"}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"], "chrom": "chr4", "pos": "37112458"}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"], "chrom": "chr20", "pos": "49921552"}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"], "chrom": "chr10", "pos": "86906761"}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"], "chrom": "chr12", "pos": "85192368"}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"], "chrom": "chr1", "pos": "26433505"}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"], "chrom": "chr17", "pos": "77961642"}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"], "chrom": "chr7", "pos": "23190612"}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"], "chrom": "chr18", "pos": "59256965"}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"], "chrom": "chr3", "pos": "7953112"}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"], "chrom": "chr1", "pos": "119718772"}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"], "chrom": "chr12", "pos": "51515436"}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"], "chrom": "chr15", "pos": "51641272"}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"], "chrom": "chr3", "pos": "177467084"}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"], "chrom": "chr2", "pos": "159443742"}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"], "chrom": "chr15", "pos": "9208331"}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"], "chrom": "chr8", "pos": "11016138"}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.96, 0.74, 0.01, 0.28], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"], "chrom": "chr4", "pos": "93217970"}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"], "chrom": "chr9", "pos": "109685447"}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"], "chrom": "chr8", "pos": "85404603"}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"], "chrom": "chr9", "pos": "26310976"}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"], "chrom": "chr12", "pos": "83082752"}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"], "chrom": "chr12", "pos": "59892443"}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"], "chrom": "chr15", "pos": "61601382"}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"], "chrom": "chr3", "pos": "112792751"}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"], "chrom": "chr2", "pos": "1276028"}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"], "chrom": "chr9", "pos": "5488020"}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"], "chrom": "chr2", "pos": "195739636"}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"], "chrom": "chr3", "pos": "4967308"}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"], "chrom": "chr18", "pos": "3791536"}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"], "chrom": "chr13", "pos": "43978569"}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"], "chrom": "chr20", "pos": "34878520"}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"], "chrom": "chr1", "pos": "192607152"}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"], "chrom": "chr1", "pos": "108730876"}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"], "chrom": "chr16", "pos": "83054051"}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"], "chrom": "chr7", "pos": "1739320"}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"], "chrom": "chr11", "pos": "81918530"}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.01, 0.09, 0.75, 0.03], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"], "chrom": "chr11", "pos": "72779563"}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr15", "pos": "74631626"}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"], "chrom": "chr11", "pos": "105419584"}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"], "chrom": "chr13", "pos": "31235332"}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"], "chrom": "chr15", "pos": "100671545"}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"], "chrom": "chr12", "pos": "10181887"}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"], "chrom": "chr8", "pos": "85536002"}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"], "chrom": "chr12", "pos": "89396230"}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"], "chrom": "chr2", "pos": "117890927"}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"], "chrom": "chr11", "pos": "77188078"}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"], "chrom": "chr4", "pos": "113590408"}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"], "chrom": "chr10", "pos": "15280573"}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"], "chrom": "chr9", "pos": "140287925"}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"], "chrom": "chr14", "pos": "83027451"}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"], "chrom": "chr17", "pos": "28217979"}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"], "chrom": "chr5", "pos": "107026837"}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"], "chrom": "chr17", "pos": "76824397"}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"], "chrom": "chr3", "pos": "194338870"}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"], "chrom": "chr5", "pos": "646819"}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"], "chrom": "chr8", "pos": "91541022"}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"], "chrom": "chr19", "pos": "12629303"}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"], "chrom": "chr4", "pos": "62487792"}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"], "chrom": "chr9", "pos": "65899379"}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"], "chrom": "chr6", "pos": "13811516"}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr2", "pos": "141016351"}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"], "chrom": "chr2", "pos": "63180458"}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"], "chrom": "chr3", "pos": "94346303"}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"], "chrom": "chr5", "pos": "18405277"}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"], "chrom": "chr2", "pos": "102011380"}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"], "chrom": "chr4", "pos": "28312378"}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"], "chrom": "chr18", "pos": "60319331"}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"], "chrom": "chr2", "pos": "98710565"}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.01, 0.04, 0.15, 0.66], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"], "chrom": "chr19", "pos": "28003645"}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"], "chrom": "chr10", "pos": "46572730"}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"], "chrom": "chr2", "pos": "187507667"}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"], "chrom": "chr2", "pos": "132632672"}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"], "chrom": "chr10", "pos": "74945835"}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"], "chrom": "chr4", "pos": "89478829"}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"], "chrom": "chr3", "pos": "129183914"}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"], "chrom": "chr19", "pos": "20753137"}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"], "chrom": "chr1", "pos": "155732526"}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"], "chrom": "chr6", "pos": "67586649"}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"], "chrom": "chr16", "pos": "28689827"}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"], "chrom": "chr18", "pos": "43153046"}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr8", "pos": "10234168"}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"], "chrom": "chr2", "pos": "178187360"}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"], "chrom": "chr9", "pos": "103609179"}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"], "chrom": "chr3", "pos": "118852316"}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"], "chrom": "chr12", "pos": "19536936"}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"], "chrom": "chr2", "pos": "154784087"}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"], "chrom": "chr2", "pos": "63896119"}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr15", "pos": "41548137"}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"], "chrom": "chr11", "pos": "134953622"}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"], "chrom": "chr4", "pos": "98907643"}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"], "chrom": "chr19", "pos": "52225547"}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"], "chrom": "chr5", "pos": "64764511"}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"], "chrom": "chr12", "pos": "26863967"}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr1", "pos": "152412016"}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"], "chrom": "chr5", "pos": "49140961"}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"], "chrom": "chr3", "pos": "133235099"}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"], "chrom": "chr3", "pos": "133203137"}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr11", "pos": "39857904"}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"], "chrom": "chr2", "pos": "6236611"}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"], "chrom": "chr7", "pos": "122826971"}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"], "chrom": "chr9", "pos": "132378857"}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"], "chrom": "chr1", "pos": "232770125"}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"], "chrom": "chr3", "pos": "182891000"}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"], "chrom": "chr3", "pos": "3079218"}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr15", "pos": "75412966"}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"], "chrom": "chr10", "pos": "113935377"}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"], "chrom": "chr4", "pos": "42944436"}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr10", "pos": "45446247"}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"], "chrom": "chr1", "pos": "219296486"}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"], "chrom": "chr6", "pos": "138504372"}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"], "chrom": "chr1", "pos": "105180724"}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr21", "pos": "44658727"}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"], "chrom": "chr1", "pos": "7333400"}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"], "chrom": "chr13", "pos": "101288184"}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"], "chrom": "chr18", "pos": "13213393"}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr1", "pos": "189508346"}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"], "chrom": "chr5", "pos": "105791975"}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"], "chrom": "chr19", "pos": "37085998"}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"], "chrom": "chr4", "pos": "13768761"}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"], "chrom": "chr5", "pos": "142128037"}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"], "chrom": "chr4", "pos": "109006791"}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"], "chrom": "chr10", "pos": "125649324"}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr1", "pos": "61872286"}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr11", "pos": "39379914"}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"], "chrom": "chr18", "pos": "37378724"}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"], "chrom": "chr5", "pos": "11911058"}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"], "chrom": "chr8", "pos": "131534148"}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"], "chrom": "chr19", "pos": "43375509"}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"], "chrom": "chr5", "pos": "82474821"}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"], "chrom": "chr17", "pos": "51719439"}}, "line_width": 12}}, "xlabels": ["T0", "T1", "T2", "T3"], "child_dict": {"1": [2, 3, 4], "2": [], "3": [], "4": [], "null": [1]}, "time_points": [0.0, 1.0, 2.0, 3.0], "tumor_sizes": [[0.0, 1.0], [1.0, 1.0], [2.0, 1.0], [3.0, 1.0]]})
    })
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.tree", {

        options: {
          patient: "",
          child_dict: {},
          tree_coordinates: {},
          cluster_dict: {}
        },

        _elements: {
          svg_tree: undefined,
          branch_trunc_labels: {},
          branch_full_labels: {}
        },

        _create: function() {
          let patient = this.options.patient,
            child_dict = this.options.child_dict,
            tree_coordinates = this.options.tree_coordinates,
            cluster_dict = this.options.cluster_dict,
            clusters = Object.keys(tree_coordinates),
            edges = [];

          for (let parent in child_dict) {
            child_dict[parent].forEach(function(child) {
              edges.push([parent, child])
            })
          }

          let svg_tree = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "visible")
            .attr("style", "max-height: 600px;")
            .attr("width", this.element.context.parentNode.getBoundingClientRect().width);
          svg_tree.append("g")
            .append("text")
              .attr("x", -20)
              .attr("y", 40)
              .attr("text-anchor", "end")
              .attr("font", "Arial")
              .attr("font-size", "20px")
              .html(patient);

          let branch_cont = svg_tree.append("g")
            .selectAll("line")
            .data(edges)
            .join("line")
            .attr("x1", d => tree_coordinates[d[0]][0])
            .attr("y1", d => tree_coordinates[d[0]][1])
            .attr("x2", d => tree_coordinates[d[1]][0])
            .attr("y2", d => tree_coordinates[d[1]][1])
            .attr("stroke", d => cluster_dict[d[1]].color)
            .attr("stroke-width", 8)
            .attr("opacity", 1.0)
            .attr("class", d => d[1]);

          let node_cont = svg_tree.append("g")
            .selectAll("circle")
            .data(clusters)
            .join("circle")
            .attr("cx", d => tree_coordinates[d][0])
            .attr("cy", d => tree_coordinates[d][1])
            .attr("r", d => d !== "null" ? 12 : 24)
            .attr("stroke", "white")
            .attr("stroke-width", 1)
            .attr("fill", d => d !== "null" ? cluster_dict[d].color : "blue")
            .attr("opacity", 1.0);

          let node_label_cont = svg_tree.append("g")
            .selectAll("text")
            .data(clusters)
            .join("text")
            .attr("x", d => tree_coordinates[d][0])
            .attr("y", d => tree_coordinates[d][1] + 5)
            .attr("text-anchor", "middle")
            .attr("fill", "white")
            .text(d => d !== "null" ? d : "normal");

          let branch_label_cont = svg_tree.append("g"),
            branch_trunc_labels = {},
            branch_full_labels = {};
          for (let e in edges) {
            let edge = edges[e],
              cnvs = Object.keys(cluster_dict[edge[1]].muts).filter(m => m.startsWith("loss") || m.startsWith("gain") || m === "WGD"),
              branch_height = Math.abs(tree_coordinates[edge[0]][1] - tree_coordinates[edge[1]][1]),
              n_labels = Math.max(4, branch_height / 10 - 2),
              label_list = [Object.keys(cluster_dict[edge[1]].muts).length, ...cluster_dict[edge[1]].drivers, ...cnvs],
              truncate = label_list.length > n_labels + 1,
              trunc_labels = truncate ? [...label_list.slice(0, n_labels), "..."] : label_list;
            branch_trunc_labels[edge[1]] = (trunc_labels);
            branch_full_labels[edge[1]] = (label_list);
            branch_label_cont.append("text")
              .attr("y", (tree_coordinates[edge[0]][1] + tree_coordinates[edge[1]][1]) / 2 - (5 * (trunc_labels.length)))
              .attr("text-anchor", "middle")
              .attr("font-size", 10)
              .attr("font-weight", "bold")
              .attr("parent", edge[0])
              .attr("child", edge[1])
              .selectAll("tspan")
              .data(trunc_labels)
              .join("tspan")
              .attr("x", (tree_coordinates[edge[0]][0] + tree_coordinates[edge[1]][0]) / 2)
              .attr("dy", 10)
              .attr("onclick", d => d === "..." ? "$(\"#tree\").tree(\"expand\", this)" : "")
              .attr("style", d => d === "..." ? "cursor: pointer;" : "")
              .text((d, i) => i ? d : "(" + d + ")");
          }

          let x_values = Object.values(tree_coordinates).map(p => p[0]),
            y_values = Object.values(tree_coordinates).map(p => p[1]),
            x_min = Math.min(...x_values),
            x_max = Math.max(...x_values),
            y_min = Math.min(...y_values),
            y_max = Math.max(...y_values),
            view_x_min = x_max - x_min > 300 ? x_min - 50 : (x_min + x_max) / 2 - 200,
            view_y_min = y_max - y_min > 400 ? y_min - 50 : (y_min + y_max) / 2 - 250,
            view_width = x_max - x_min > 300 ? x_max - x_min + 100 : 400,
            view_height = y_max - y_min > 400 ? y_max - y_min + 100 : 500;

          svg_tree.attr("viewBox", [view_x_min, view_y_min, view_width, view_height].join(","));

          this._elements.svg_tree = svg_tree.node();
          this._elements.branch_full_labels = branch_full_labels;
          this._elements.branch_trunc_labels = branch_trunc_labels;

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.svg_tree.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.svg_tree.outerHTML.replace("viewbox", "viewBox")),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "Example_ND" + ".tree.svg");
          dl.click();
        },

        expand: function(label) {
          let branch_label = d3.select(label.parentElement),
            parent = branch_label.attr("parent"),
            child = branch_label.attr("child"),
            label_list = [...this._elements.branch_full_labels[child], "Condense ^"],
            tree_coordinates = this.options.tree_coordinates;
          branch_label
            .attr("y", (tree_coordinates[parent][1] + tree_coordinates[child][1]) / 2 - (5 * (label_list.length)))
            .selectAll("tspan")
            .data(label_list)
            .join("tspan")
            .attr("x", (tree_coordinates[parent][0] + tree_coordinates[child][0]) / 2)
            .attr("dy", 10)
            .attr("onclick", d => d === "Condense ^" ? "$(\"#tree\").tree(\"condense\", this)" : "")
            .attr("style", d => d === "Condense ^" ? "cursor: pointer;" : "")
            .text((d, i) => i ? d : "(" + d + ")")
        },

        condense: function(label) {
          let branch_label = d3.select(label.parentElement),
            parent = branch_label.attr("parent"),
            child = branch_label.attr("child"),
            trunc_labels = this._elements.branch_trunc_labels[child],
            tree_coordinates = this.options.tree_coordinates;
          branch_label
            .attr("y", (tree_coordinates[parent][1] + tree_coordinates[child][1]) / 2 - (5 * (trunc_labels.length)))
            .selectAll("tspan")
            .data(trunc_labels)
            .join("tspan")
            .attr("x", (tree_coordinates[parent][0] + tree_coordinates[child][0]) / 2)
            .attr("dy", 10)
            .attr("onclick", d => d === "..." ? "$(\"#tree\").tree(\"expand\", this)" : "")
            .attr("style", d => d === "..." ? "cursor: pointer;" : "")
            .text((d, i) => i ? d : "(" + d + ")")
        },

        _destroy: function() {
          this.element.context.innerHTML = ""
        }

      });

      let tree_options = {"tree_coordinates": {"1": [0.0, 200.0], "null": [0.0, 0.0], "3": [153.21158810923683, 271.44373685342646], "4": [-156.58375227052179, 290.4036715241074], "2": [13.807985354697136, 357.8259947999506]}, "cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [0.98, 1.0, 0.92, 0.97], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"], "chrom": "chr1", "pos": "203116592"}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"], "chrom": "chr6", "pos": "54069115"}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"], "chrom": "chr6", "pos": "31180141"}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"], "chrom": "chr16", "pos": "12137783"}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"], "chrom": "chr4", "pos": "12358155"}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"], "chrom": "chr5", "pos": "39128627"}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"], "chrom": "chr6", "pos": "1417608"}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"], "chrom": "chr10", "pos": "44150814"}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"], "chrom": "chr14", "pos": "41194468"}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"], "chrom": "chr1", "pos": "83112457"}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"], "chrom": "chr7", "pos": "125483252"}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"], "chrom": "chr1", "pos": "132144794"}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"], "chrom": "chr6", "pos": "74165244"}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"], "chrom": "chr8", "pos": "23624864"}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"], "chrom": "chr11", "pos": "71847859"}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"], "chrom": "chr10", "pos": "2401524"}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"], "chrom": "chr2", "pos": "155758820"}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"], "chrom": "chr1", "pos": "216025272"}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"], "chrom": "chr9", "pos": "54906067"}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"], "chrom": "chr16", "pos": "4448042"}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"], "chrom": "chr11", "pos": "42572643"}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"], "chrom": "chr8", "pos": "68794502"}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"], "chrom": "chr2", "pos": "221118783"}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"], "chrom": "chr16", "pos": "60609731"}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"], "chrom": "chr11", "pos": "132617216"}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"], "chrom": "chr2", "pos": "134658375"}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"], "chrom": "chr11", "pos": "85707387"}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"], "chrom": "chr4", "pos": "37112458"}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"], "chrom": "chr20", "pos": "49921552"}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"], "chrom": "chr10", "pos": "86906761"}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"], "chrom": "chr12", "pos": "85192368"}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"], "chrom": "chr1", "pos": "26433505"}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"], "chrom": "chr17", "pos": "77961642"}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"], "chrom": "chr7", "pos": "23190612"}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"], "chrom": "chr18", "pos": "59256965"}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"], "chrom": "chr3", "pos": "7953112"}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"], "chrom": "chr1", "pos": "119718772"}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"], "chrom": "chr12", "pos": "51515436"}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"], "chrom": "chr15", "pos": "51641272"}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"], "chrom": "chr3", "pos": "177467084"}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"], "chrom": "chr2", "pos": "159443742"}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"], "chrom": "chr15", "pos": "9208331"}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"], "chrom": "chr8", "pos": "11016138"}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.96, 0.74, 0.01, 0.28], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"], "chrom": "chr4", "pos": "93217970"}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"], "chrom": "chr9", "pos": "109685447"}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"], "chrom": "chr8", "pos": "85404603"}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"], "chrom": "chr9", "pos": "26310976"}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"], "chrom": "chr12", "pos": "83082752"}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"], "chrom": "chr12", "pos": "59892443"}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"], "chrom": "chr15", "pos": "61601382"}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"], "chrom": "chr3", "pos": "112792751"}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"], "chrom": "chr2", "pos": "1276028"}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"], "chrom": "chr9", "pos": "5488020"}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"], "chrom": "chr2", "pos": "195739636"}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"], "chrom": "chr3", "pos": "4967308"}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"], "chrom": "chr18", "pos": "3791536"}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"], "chrom": "chr13", "pos": "43978569"}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"], "chrom": "chr20", "pos": "34878520"}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"], "chrom": "chr1", "pos": "192607152"}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"], "chrom": "chr1", "pos": "108730876"}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"], "chrom": "chr16", "pos": "83054051"}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"], "chrom": "chr7", "pos": "1739320"}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"], "chrom": "chr11", "pos": "81918530"}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.01, 0.09, 0.75, 0.03], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"], "chrom": "chr11", "pos": "72779563"}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr15", "pos": "74631626"}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"], "chrom": "chr11", "pos": "105419584"}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"], "chrom": "chr13", "pos": "31235332"}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"], "chrom": "chr15", "pos": "100671545"}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"], "chrom": "chr12", "pos": "10181887"}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"], "chrom": "chr8", "pos": "85536002"}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"], "chrom": "chr12", "pos": "89396230"}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"], "chrom": "chr2", "pos": "117890927"}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"], "chrom": "chr11", "pos": "77188078"}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"], "chrom": "chr4", "pos": "113590408"}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"], "chrom": "chr10", "pos": "15280573"}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"], "chrom": "chr9", "pos": "140287925"}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"], "chrom": "chr14", "pos": "83027451"}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"], "chrom": "chr17", "pos": "28217979"}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"], "chrom": "chr5", "pos": "107026837"}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"], "chrom": "chr17", "pos": "76824397"}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"], "chrom": "chr3", "pos": "194338870"}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"], "chrom": "chr5", "pos": "646819"}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"], "chrom": "chr8", "pos": "91541022"}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"], "chrom": "chr19", "pos": "12629303"}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"], "chrom": "chr4", "pos": "62487792"}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"], "chrom": "chr9", "pos": "65899379"}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"], "chrom": "chr6", "pos": "13811516"}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr2", "pos": "141016351"}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"], "chrom": "chr2", "pos": "63180458"}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"], "chrom": "chr3", "pos": "94346303"}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"], "chrom": "chr5", "pos": "18405277"}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"], "chrom": "chr2", "pos": "102011380"}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"], "chrom": "chr4", "pos": "28312378"}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"], "chrom": "chr18", "pos": "60319331"}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"], "chrom": "chr2", "pos": "98710565"}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.01, 0.04, 0.15, 0.66], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"], "chrom": "chr19", "pos": "28003645"}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"], "chrom": "chr10", "pos": "46572730"}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"], "chrom": "chr2", "pos": "187507667"}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"], "chrom": "chr2", "pos": "132632672"}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"], "chrom": "chr10", "pos": "74945835"}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"], "chrom": "chr4", "pos": "89478829"}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"], "chrom": "chr3", "pos": "129183914"}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"], "chrom": "chr19", "pos": "20753137"}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"], "chrom": "chr1", "pos": "155732526"}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"], "chrom": "chr6", "pos": "67586649"}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"], "chrom": "chr16", "pos": "28689827"}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"], "chrom": "chr18", "pos": "43153046"}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr8", "pos": "10234168"}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"], "chrom": "chr2", "pos": "178187360"}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"], "chrom": "chr9", "pos": "103609179"}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"], "chrom": "chr3", "pos": "118852316"}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"], "chrom": "chr12", "pos": "19536936"}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"], "chrom": "chr2", "pos": "154784087"}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"], "chrom": "chr2", "pos": "63896119"}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr15", "pos": "41548137"}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"], "chrom": "chr11", "pos": "134953622"}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"], "chrom": "chr4", "pos": "98907643"}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"], "chrom": "chr19", "pos": "52225547"}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"], "chrom": "chr5", "pos": "64764511"}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"], "chrom": "chr12", "pos": "26863967"}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr1", "pos": "152412016"}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"], "chrom": "chr5", "pos": "49140961"}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"], "chrom": "chr3", "pos": "133235099"}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"], "chrom": "chr3", "pos": "133203137"}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr11", "pos": "39857904"}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"], "chrom": "chr2", "pos": "6236611"}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"], "chrom": "chr7", "pos": "122826971"}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"], "chrom": "chr9", "pos": "132378857"}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"], "chrom": "chr1", "pos": "232770125"}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"], "chrom": "chr3", "pos": "182891000"}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"], "chrom": "chr3", "pos": "3079218"}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr15", "pos": "75412966"}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"], "chrom": "chr10", "pos": "113935377"}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"], "chrom": "chr4", "pos": "42944436"}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr10", "pos": "45446247"}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"], "chrom": "chr1", "pos": "219296486"}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"], "chrom": "chr6", "pos": "138504372"}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"], "chrom": "chr1", "pos": "105180724"}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr21", "pos": "44658727"}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"], "chrom": "chr1", "pos": "7333400"}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"], "chrom": "chr13", "pos": "101288184"}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"], "chrom": "chr18", "pos": "13213393"}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr1", "pos": "189508346"}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"], "chrom": "chr5", "pos": "105791975"}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"], "chrom": "chr19", "pos": "37085998"}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"], "chrom": "chr4", "pos": "13768761"}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"], "chrom": "chr5", "pos": "142128037"}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"], "chrom": "chr4", "pos": "109006791"}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"], "chrom": "chr10", "pos": "125649324"}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr1", "pos": "61872286"}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr11", "pos": "39379914"}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"], "chrom": "chr18", "pos": "37378724"}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"], "chrom": "chr5", "pos": "11911058"}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"], "chrom": "chr8", "pos": "131534148"}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"], "chrom": "chr19", "pos": "43375509"}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"], "chrom": "chr5", "pos": "82474821"}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"], "chrom": "chr17", "pos": "51719439"}}, "line_width": 12}}, "child_dict": {"1": [2, 3, 4], "2": [], "3": [], "4": [], "null": [1]}, "patient": "Example_ND"};

      if (tree_options) {
        let tree_div = $("#tree");
        d3.select(tree_div[0].parentElement).append("button")
          .attr("onclick", "$(\"#tree\").tree(\"download\")")
          .attr("style", "font-size: 12px;")
          .html("Download as SVG");
        tree_div.tree(tree_options)
      } else {
        $("#tree").append("h3")
          .html("Run BuildTree to display tree")
      }

    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.tree_switch", {
        options: {
          patient: "",
          tree_iterations: [],
          child_dicts: [],
          tree_coordinates: [],
          cluster_dict: {}
        },

        _create: function() {
          let tree_iterations = this.options.tree_iterations,
            widg = this;

          let dropdown = d3.select(this.element.context).append("select")
            .attr("class", "form-control");

          dropdown.selectAll("option")
            .data(tree_iterations)
            .join("option")
            .html((d, i) => "Tree " + (i + 1) + " (" + d + ")");

          dropdown.on("change", function() {widg.switch_tree(this.selectedIndex)})
        },

        switch_tree: function(i) {
          let patient = this.options.patient,
            child_dicts = this.options.child_dicts,
            tree_coordinates = this.options.tree_coordinates,
            cluster_dict = this.options.cluster_dict,
            tree = $("#tree");

          tree.tree("destroy");

          tree.tree({
            patient: patient,
            child_dict: child_dicts[i],
            tree_coordinates: tree_coordinates[i],
            cluster_dict: cluster_dict
          })
        }
      });

      let tree_switch_options = false;

      if (tree_switch_options) {
        $("#tree-switch").tree_switch(tree_switch_options)
      }
    })
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.treatment_plot", {

        options: {
          width: 500,
          height: 50,
          margins: {right: 50, left: 50},
          treatments: [],
          samples: [],
          treatment_color_map: {}
        },

        _elements: {
          treatment_plot: undefined,
          tooltip: undefined
        },

        _create: function() {
          const width = this.options.width,
            height = this.options.height,
            margins = this.options.margins,
            treatments = this.options.treatments,
            samples = this.options.samples,
            treatment_color_map = this.options.treatment_color_map;

          let t = d3.scaleLinear()
            .domain([Math.min(...samples), Math.max(...samples)])
            .range([margins.left, width - margins.right]);

          let xAxis = g => g
            .attr("transform", "translate(0 " + height.toString() + ")")
            .call(d3.axisBottom(t));

          let treatment_plot = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("viewBox", "0 0 " + width + " " + (height * 2))
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "visible")
            .attr("onclick", "$(\"#treatment-plot\").treatment_plot(\"toggle_tx\", event)")
            .style("max-height", "100px");
          treatment_plot.append("g")
            .call(xAxis);

          for (let tx in treatments) {
            let tx_start = Math.max(treatments[tx].tx_start, samples[0]),
              tx_end = Math.min(treatments[tx].tx_end, samples[samples.length - 1]);
            if (tx_end > samples[0] && tx_start < samples[samples.length - 1]) {
              let color = treatment_color_map[treatments[tx].tx];
              treatment_plot.append("line")
                .attr("stroke", color)
                .attr("stroke-width", 10)
                .attr("x1", t(tx_start))
                .attr("x2", t(tx_end))
                .attr("y1", 25)
                .attr("y2", 25)
                .attr("opacity", 1.0)
                .attr("tx", treatments[tx].tx)
                .attr("style", "cursor: pointer;")
            }
          }

          for (let s in samples) {
            treatment_plot.append("line")
              .attr("stroke", "black")
              .attr("stroke-width", 1)
              .attr("x1", t(samples[s]))
              .attr("x2", t(samples[s]))
              .attr("y1", 10)
              .attr("y2", 40)
              .attr("opacity", 1.0);
          }

          this._elements.tooltip = treatment_plot.append("g")
            .attr("style", "display: none;")
            .node();
          this._elements.treatment_plot = treatment_plot.node();

          this._refresh()
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.treatment_plot.outerHTML
        },

        toggle_tx: function(eve) {
          if (typeof eve.target.getAttribute("tx") === "string") {
            let tx_line = eve.target,
              tooltip = d3.select(this._elements.tooltip);
            let {x, width} = tx_line.getBBox(),
              tx_mid = x + (width / 2);
            tooltip.attr("style", "display: block;")
              .attr("transform", "translate(" + tx_mid.toString() + ",60)");

            let border = tooltip.selectAll("path")
              .data([null])
              .join("path")
                .attr("fill", "white")
                .attr("stroke", "black");

            tooltip.selectAll("text")
              .data([null])
              .join("text")
              .attr("id", "treatment-text")
              .attr("text-anchor", "middle")
              .call(t => t
                .selectAll("tspan")
                .data([tx_line.getAttribute("tx")])
                .join("tspan")
                .attr("x", 0)
                .attr("y", 0)
                .text(d => d));

            this._refresh();

            let {width: w, height: h} = $("#treatment-text")[0].getBBox();

            border.attr("d", "M" + (-w / 2 - 10).toString() + " " + (-h / 2 - 15).toString() + " H " +
              (w / 2 + 10).toString() + " V " + (h / 2 + 5).toString() + " H " + (-w / 2 - 10).toString() + " Z");
          } else {
            this._elements.tooltip.setAttribute("style", "display: none;");
          }

          this._refresh();
        }

      });

      let treatment_data = false;

      if (treatment_data) {
        $("#treatment-plot").treatment_plot(treatment_data);
      }

    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.mutation_visual", {
        options: {
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], color: "green", muts: {}, drivers: []}},
          aliases: []
        },

        _elements: {
          mutation_visual: undefined
        },

        _create: function() {
          const cluster_dict = this.options.cluster_dict,
            aliases = this.options.aliases;
          let svg_visual = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "auto"),
            c_groups = [[], [], [], []],
            group_names = ["UNIVERSAL MUTATIONS", "OTHER COMMON MUTATIONS", "OTHER CLONAL", "SUBCLONAL"],
            group_min_lens = [200, 200, 150, 150];
          for (let c in cluster_dict) {
            let clonality = [];
            for (let s in cluster_dict[c].ccf_hat) {
              let cl = cluster_dict[c].ccf_hat[s];
              if (cl > 0.9) {
                clonality.push(1);
              } else if (cl > 0.1) {
                clonality.push(0.5);
              } else {
                clonality.push(0);
              }
            }
            if (clonality.every(v => v === 1)) {
              c_groups[0].push(c);
            } else if (clonality.reduce((p, a) => p + a) > 1) {
              c_groups[1].push(c);
            } else if (clonality.some(v => v === 1)) {
              c_groups[2].push(c);
            } else {
              c_groups[3].push(c);
            }
          }

          for (let a in aliases) {
            svg_visual.append("g")
              .attr("transform", "translate(15," + (a * 12 + 133).toString() + ")")
              .append("svg")
                .attr("width", "100px")
                .attr("height", "20px")
                .attr("x", 10)
                .attr("y", 10)
                .attr("stroke-width", 1)
                .attr("stroke", "black")
                .append("text")
                  .html(aliases[a])
                  .attr("font-size", "9px")
                  .attr("x", 10)
                  .attr("y", 10)
                  .attr("text-anchor", "start")
                  .attr("textLength", 50)
                  .attr("class", "samples");
          }

          let x_offset = 20,
            y_offset = 30,
            header_x_offset = 70;

          for (let g in c_groups) {
            if (c_groups[g].length) {
              let g_len = 0;
              for (let i in c_groups[g]) {
                let c = c_groups[g][i],
                  box_stroke = cluster_dict[c].color,
                  drivers = cluster_dict[c].drivers,
                  muts = cluster_dict[c].muts,
                  sorted_muts = Object.keys(muts).sort(function(a, b) {
                    if (drivers.includes(a) && drivers.includes(b)) {
                      return 0
                    }
                    if (drivers.includes(a)) {
                      return -1
                    }
                    if (drivers.includes(b)) {
                      return 1
                    }
                    return 0
                  });
                g_len += sorted_muts.length * 12;
                for (let ii in sorted_muts) {
                  let mut = sorted_muts[ii],
                    mut_group = svg_visual.append("g")
                    .attr("class", "mut_group"),
                    mut_suffix = mut.includes("_") ? mut.split("_")[1] : "p.A0A",
                    text_color = mut.startsWith("loss") || mut.startsWith("gain") ?
                      "black" : ((mut_suffix.length > 3 && mut_suffix[2] === mut_suffix[mut_suffix.length - 1]) ? "gray" : "black"),
                    text_weight = drivers.includes(mut) ? "bold" : "normal";
                  mut_group.append("g")
                    .attr("transform", "rotate(-75," + (x_offset + 53).toString() + ",145) " +
                      "translate(" + (x_offset + 53).toString() + ",145)")
                    .append("svg")
                      .attr("width", "100px")
                      .attr("height", "20px")
                      .attr("x", 10)
                      .attr("y", 10)
                      .append("text")
                        .html(mut)
                        .attr("font-size", "9px")
                        .attr("font-family", "Arial")
                        .attr("fill", text_color)
                        .attr("x", 10)
                        .attr("y", 10)
                        .attr("text-anchor", "start")
                        .attr("textLength", 70)
                        .attr("font-weight", text_weight)
                        .attr("class", "cluster_" + c.toString());
                  for (let a in aliases) {
                    let ccf_hat = cluster_dict[c].ccf_hat[a],
                      ccf_1d = muts[mut].ccf_hat[a],
                      box_color = ccf_1d < 0.1 ? "white" : cluster_dict[c].color,
                      box_size = ccf_hat * 9 + 1,
                      a_box_stroke = ccf_hat > 0.9 ? "red" : box_stroke;
                    mut_group.append("rect")
                      .attr("x", x_offset + 75 - (box_size / 2.0))
                      .attr("y", y_offset + 120 + (a * 12) - (box_size / 2.0))
                      .attr("width", box_size.toString() + "px")
                      .attr("height", box_size.toString() + "px")
                      .attr("stroke-width", 1)
                      .attr("stroke", a_box_stroke)
                      .attr("fill", box_color)
                      .attr("opacity", 0.8)
                      .attr("class", "cluster_" + c.toString());
                  }
                  x_offset += 12;
                }
              }
              svg_visual.append("g")
                .attr("transform", "translate(" + (20 + header_x_offset).toString() + ",30)")
                .append("svg")
                  .attr("width", g_len)
                  .attr("height", "20px")
                  .attr("x", 10)
                  .attr("y", 10)
                  .attr("stroke-width", 1)
                  .attr("stroke", "black")
                  .append("text")
                    .html(group_names[g])
                    .attr("font-size", g_len > group_min_lens[g] ? "12px" : "8px")
                    .attr("x", 10)
                    .attr("y", 10)
                    .attr("text-anchor", "start");
              header_x_offset += g_len + 8;
              x_offset += 10;
            }
          }
          svg_visual
            .attr("width", x_offset + 110)
            .attr("height", y_offset + 160 + (aliases.length * 12));
          this._elements.mutation_visual = svg_visual.node();

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.mutation_visual.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.mutation_visual.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "Example_ND" + ".clonality_chart.svg");
          dl.click();
        }
      });

      $("#mutation-visual").mutation_visual({"cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [0.98, 1.0, 0.92, 0.97], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"], "chrom": "chr1", "pos": "203116592"}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"], "chrom": "chr6", "pos": "54069115"}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"], "chrom": "chr6", "pos": "31180141"}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"], "chrom": "chr16", "pos": "12137783"}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"], "chrom": "chr4", "pos": "12358155"}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"], "chrom": "chr5", "pos": "39128627"}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"], "chrom": "chr6", "pos": "1417608"}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"], "chrom": "chr10", "pos": "44150814"}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"], "chrom": "chr14", "pos": "41194468"}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"], "chrom": "chr1", "pos": "83112457"}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"], "chrom": "chr7", "pos": "125483252"}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"], "chrom": "chr1", "pos": "132144794"}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"], "chrom": "chr6", "pos": "74165244"}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"], "chrom": "chr8", "pos": "23624864"}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"], "chrom": "chr11", "pos": "71847859"}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"], "chrom": "chr10", "pos": "2401524"}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"], "chrom": "chr2", "pos": "155758820"}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"], "chrom": "chr1", "pos": "216025272"}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"], "chrom": "chr9", "pos": "54906067"}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"], "chrom": "chr16", "pos": "4448042"}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"], "chrom": "chr11", "pos": "42572643"}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"], "chrom": "chr8", "pos": "68794502"}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"], "chrom": "chr2", "pos": "221118783"}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"], "chrom": "chr16", "pos": "60609731"}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"], "chrom": "chr11", "pos": "132617216"}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"], "chrom": "chr2", "pos": "134658375"}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"], "chrom": "chr11", "pos": "85707387"}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"], "chrom": "chr4", "pos": "37112458"}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"], "chrom": "chr20", "pos": "49921552"}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"], "chrom": "chr10", "pos": "86906761"}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"], "chrom": "chr12", "pos": "85192368"}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"], "chrom": "chr1", "pos": "26433505"}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"], "chrom": "chr17", "pos": "77961642"}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"], "chrom": "chr7", "pos": "23190612"}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"], "chrom": "chr18", "pos": "59256965"}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"], "chrom": "chr3", "pos": "7953112"}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"], "chrom": "chr1", "pos": "119718772"}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"], "chrom": "chr12", "pos": "51515436"}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"], "chrom": "chr15", "pos": "51641272"}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"], "chrom": "chr3", "pos": "177467084"}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"], "chrom": "chr2", "pos": "159443742"}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"], "chrom": "chr15", "pos": "9208331"}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"], "chrom": "chr8", "pos": "11016138"}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.96, 0.74, 0.01, 0.28], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"], "chrom": "chr4", "pos": "93217970"}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"], "chrom": "chr9", "pos": "109685447"}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"], "chrom": "chr8", "pos": "85404603"}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"], "chrom": "chr9", "pos": "26310976"}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"], "chrom": "chr12", "pos": "83082752"}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"], "chrom": "chr12", "pos": "59892443"}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"], "chrom": "chr15", "pos": "61601382"}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"], "chrom": "chr3", "pos": "112792751"}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"], "chrom": "chr2", "pos": "1276028"}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"], "chrom": "chr9", "pos": "5488020"}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"], "chrom": "chr2", "pos": "195739636"}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"], "chrom": "chr3", "pos": "4967308"}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"], "chrom": "chr18", "pos": "3791536"}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"], "chrom": "chr13", "pos": "43978569"}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"], "chrom": "chr20", "pos": "34878520"}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"], "chrom": "chr1", "pos": "192607152"}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"], "chrom": "chr1", "pos": "108730876"}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"], "chrom": "chr16", "pos": "83054051"}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"], "chrom": "chr7", "pos": "1739320"}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"], "chrom": "chr11", "pos": "81918530"}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.01, 0.09, 0.75, 0.03], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"], "chrom": "chr11", "pos": "72779563"}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr15", "pos": "74631626"}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"], "chrom": "chr11", "pos": "105419584"}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"], "chrom": "chr13", "pos": "31235332"}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"], "chrom": "chr15", "pos": "100671545"}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"], "chrom": "chr12", "pos": "10181887"}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"], "chrom": "chr8", "pos": "85536002"}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"], "chrom": "chr12", "pos": "89396230"}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"], "chrom": "chr2", "pos": "117890927"}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"], "chrom": "chr11", "pos": "77188078"}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"], "chrom": "chr4", "pos": "113590408"}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"], "chrom": "chr10", "pos": "15280573"}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"], "chrom": "chr9", "pos": "140287925"}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"], "chrom": "chr14", "pos": "83027451"}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"], "chrom": "chr17", "pos": "28217979"}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"], "chrom": "chr5", "pos": "107026837"}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"], "chrom": "chr17", "pos": "76824397"}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"], "chrom": "chr3", "pos": "194338870"}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"], "chrom": "chr5", "pos": "646819"}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"], "chrom": "chr8", "pos": "91541022"}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"], "chrom": "chr19", "pos": "12629303"}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"], "chrom": "chr4", "pos": "62487792"}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"], "chrom": "chr9", "pos": "65899379"}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"], "chrom": "chr6", "pos": "13811516"}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr2", "pos": "141016351"}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"], "chrom": "chr2", "pos": "63180458"}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"], "chrom": "chr3", "pos": "94346303"}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"], "chrom": "chr5", "pos": "18405277"}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"], "chrom": "chr2", "pos": "102011380"}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"], "chrom": "chr4", "pos": "28312378"}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"], "chrom": "chr18", "pos": "60319331"}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"], "chrom": "chr2", "pos": "98710565"}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.01, 0.04, 0.15, 0.66], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"], "chrom": "chr19", "pos": "28003645"}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"], "chrom": "chr10", "pos": "46572730"}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"], "chrom": "chr2", "pos": "187507667"}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"], "chrom": "chr2", "pos": "132632672"}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"], "chrom": "chr10", "pos": "74945835"}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"], "chrom": "chr4", "pos": "89478829"}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"], "chrom": "chr3", "pos": "129183914"}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"], "chrom": "chr19", "pos": "20753137"}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"], "chrom": "chr1", "pos": "155732526"}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"], "chrom": "chr6", "pos": "67586649"}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"], "chrom": "chr16", "pos": "28689827"}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"], "chrom": "chr18", "pos": "43153046"}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr8", "pos": "10234168"}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"], "chrom": "chr2", "pos": "178187360"}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"], "chrom": "chr9", "pos": "103609179"}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"], "chrom": "chr3", "pos": "118852316"}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"], "chrom": "chr12", "pos": "19536936"}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"], "chrom": "chr2", "pos": "154784087"}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"], "chrom": "chr2", "pos": "63896119"}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr15", "pos": "41548137"}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"], "chrom": "chr11", "pos": "134953622"}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"], "chrom": "chr4", "pos": "98907643"}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"], "chrom": "chr19", "pos": "52225547"}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"], "chrom": "chr5", "pos": "64764511"}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"], "chrom": "chr12", "pos": "26863967"}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr1", "pos": "152412016"}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"], "chrom": "chr5", "pos": "49140961"}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"], "chrom": "chr3", "pos": "133235099"}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"], "chrom": "chr3", "pos": "133203137"}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr11", "pos": "39857904"}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"], "chrom": "chr2", "pos": "6236611"}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"], "chrom": "chr7", "pos": "122826971"}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"], "chrom": "chr9", "pos": "132378857"}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"], "chrom": "chr1", "pos": "232770125"}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"], "chrom": "chr3", "pos": "182891000"}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"], "chrom": "chr3", "pos": "3079218"}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr15", "pos": "75412966"}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"], "chrom": "chr10", "pos": "113935377"}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"], "chrom": "chr4", "pos": "42944436"}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr10", "pos": "45446247"}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"], "chrom": "chr1", "pos": "219296486"}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"], "chrom": "chr6", "pos": "138504372"}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"], "chrom": "chr1", "pos": "105180724"}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr21", "pos": "44658727"}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"], "chrom": "chr1", "pos": "7333400"}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"], "chrom": "chr13", "pos": "101288184"}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"], "chrom": "chr18", "pos": "13213393"}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr1", "pos": "189508346"}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"], "chrom": "chr5", "pos": "105791975"}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"], "chrom": "chr19", "pos": "37085998"}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"], "chrom": "chr4", "pos": "13768761"}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"], "chrom": "chr5", "pos": "142128037"}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"], "chrom": "chr4", "pos": "109006791"}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"], "chrom": "chr10", "pos": "125649324"}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr1", "pos": "61872286"}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr11", "pos": "39379914"}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"], "chrom": "chr18", "pos": "37378724"}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"], "chrom": "chr5", "pos": "11911058"}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"], "chrom": "chr8", "pos": "131534148"}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"], "chrom": "chr19", "pos": "43375509"}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"], "chrom": "chr5", "pos": "82474821"}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"], "chrom": "chr17", "pos": "51719439"}}, "line_width": 12}}, "aliases": ["T0", "T1", "T2", "T3"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.cluster_table", {

        options: {
          aliases: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], color: "green", muts: {}}},
        },

        _elements: {
          cluster_table: undefined,
          column_data: undefined,
          table_data: undefined,
          cluster_datatable: undefined
        },

        _create: function() {
          let aliases = this.options.aliases,
            cluster_dict = this.options.cluster_dict,
            table_el = d3.select(document.createElement("table"))
              .attr("id", "cluster_table")
              .attr("class", "hover"),
            col_width = Math.round(82 / (aliases.length + 1.3)),
            cluster_col_width = 82 - (aliases.length * col_width),
            columns = [{"data": "Cluster", "width": cluster_col_width + "%"},
              {"data": "Chromosome", "width": "9%"},
              {"data": "Position", "width": "9%"}
            ],
            col_list = ["Cluster", "Chromosome", "Position"];
          for (let i in aliases) {
            columns.push({"data": aliases[i] + " CCF", "width": col_width + "%"});
            col_list.push(aliases[i] + " CCF");
          }
          table_el.append("thead")
            .selectAll("th")
            .data(col_list)
            .join("th")
            .text(d => d);
          let cluster_data = [];
          for (let c in cluster_dict) {
            let cluster_dat = {"Cluster": c, "Chromosome": null, "Position": null};
            for (let i in aliases) {
              cluster_dat[aliases[i] + " CCF"] = cluster_dict[c].ccf_hat[i] + " (" + cluster_dict[c].ccf_low[i] + "-" + cluster_dict[c].ccf_high[i] + ")";
            }
            cluster_data.push(cluster_dat);
          }
          this._elements.cluster_table = table_el.node();
          this._elements.column_data = columns;
          this._elements.table_data = {"columns": columns,
            "data": cluster_data,
            "order": [[0, "asc"]],
            "paging": false,
            "bInfo": false,
            "createdRow": function(row, data, dataIndex) {
              $(row).css("color", cluster_dict[dataIndex + 1].color)
                .css("cursor", "pointer")
                .attr("id", "mutation_row_cluster " + (dataIndex + 1).toString())
            }};

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.cluster_table.outerHTML;
          this._elements.cluster_datatable = $("#cluster_table").DataTable(this._elements.table_data);
          $("#cluster_table tbody").on("click", "tr", this.toggle_mutations(this));
          let search_input = $(".dataTables_filter input");
          search_input.unbind().bind("keyup", function(e) {
            if (search_input.val().length === 0) {
              for (let c in this.options.cluster_dict) {
                this.hide_mutations(c);
              }
            } else if (e.keyCode === 13) {
              for (let c in this.options.cluster_dict) {
                let cluster_table = this.show_mutations(c);
                cluster_table.search(search_input.val()).draw();
                if (cluster_table.page.info().recordsDisplay === 0) {
                  this.hide_mutations(c);
                }
              }
            }
          }
          .bind(this));
        },

        toggle_mutations: function(widg) {
          return function() {
            let row = widg._elements.cluster_datatable.row($(this));
            if (row.data()) {
              if (row.child.isShown()) {
                row.child.hide();
              } else {
                let c = row.data().Cluster,
                  cluster_muts = widg.options.cluster_dict[c].muts,
                  drivers = widg.options.cluster_dict[c].drivers,
                  color = widg.options.cluster_dict[c].color,
                  aliases = widg.options.aliases,
                  mut_data = [];
                for (let mut in cluster_muts) {
                  let mut_dat = {"is_driver": drivers.includes(mut) ? 0 : 1,
                      "Cluster": mut,
                      "Chromosome": cluster_muts[mut].chrom,
                      "Position": cluster_muts[mut].pos
                    },
                    is_cnv = mut.startsWith("gain") || mut.startsWith("loss") || mut.startsWith("homdel") || mut === "WGD";
                  for (let i in aliases) {
                    mut_dat[aliases[i] + " CCF"] = cluster_muts[mut].ccf_hat[i] +
                      (is_cnv ? "" : " (" + cluster_muts[mut].alt_cnt[i] + ":" + cluster_muts[mut].ref_cnt[i] + ")");
                  }
                  mut_data.push(mut_dat);
                }
                row.child("<table id=\"cluster_" + row.data().Cluster + "_table\" class=\"hover\"></table>").show();
                $("#cluster_" + row.data().Cluster + "_table").DataTable({
                  "columns": [{"data": "is_driver", "visible": false}].concat(widg._elements.column_data),
                  "data": mut_data,
                  "autoWidth": false,
                  "order": [[0, "asc"]],
                  "paging": false,
                  "scrollY": 320,
                  "scrollCollapse": true,
                  "createdRow": function(row, data) {
                    $(row).css("color", color);
                    if (data.is_driver === 0) {
                      $(row).css("font-weight", "bold");
                    }
                  }
                });
              }
            }
          }
        },

        show_mutations: function(cluster) {
          let row = this._elements.cluster_datatable.row(cluster - 1),
            cluster_table;
          if (~row.child.isShown()) {
            let cluster_muts = this.options.cluster_dict[cluster].muts,
              drivers = this.options.cluster_dict[cluster].drivers,
              color = this.options.cluster_dict[cluster].color,
              aliases = this.options.aliases,
              mut_data = [];
            for (let mut in cluster_muts) {
              let mut_dat = {"is_driver": drivers.includes(mut) ? 0 : 1,
                  "Cluster": mut,
                  "Chromosome": cluster_muts[mut].chrom,
                  "Position": cluster_muts[mut].pos
                },
                is_cnv = mut.startsWith("gain") || mut.startsWith("loss") || mut.startsWith("homdel") || mut === "WGD";
              for (let i in aliases) {
                mut_dat[aliases[i] + " CCF"] = cluster_muts[mut].ccf_hat[i] +
                  (is_cnv ? "" : " (" + cluster_muts[mut].alt_cnt[i] + ":" + cluster_muts[mut].ref_cnt[i] + ")");
              }
              mut_data.push(mut_dat);
            }
            row.child("<table id=\"cluster_" + cluster.toString() + "_table\" class=\"hover\"></table>").show();
            cluster_table = $("#cluster_" + cluster.toString() + "_table").DataTable({
              "columns": [{"data": "is_driver", "visible": false}].concat(this._elements.column_data),
              "data": mut_data,
              "autoWidth": false,
              "order": [[0, "asc"]],
              "paging": false,
              "scrollY": 320,
              "scrollCollapse": true,
              "createdRow": function(row, data) {
                $(row).css("color", color);
                if (data.is_driver === 0) {
                  $(row).css("font-weight", "bold");
                }
              }
            });
          } else {
            cluster_table = row.child.DataTable();
          }
          return cluster_table;
        },

        hide_mutations: function(cluster) {
          this._elements.cluster_datatable.row(cluster - 1).child.hide();
        },

        download_as_tsv: function() {
          let aliases = this.options.aliases,
            cluster_dict = this.options.cluster_dict,
            columns = ["Cluster", "Mutation", "Driver", "Chromosome", "Position", ...aliases.map(d => d + " CCF")],
            dl_link = "data:text/plain;charset=utf-8,";
          
          let is_driver = function(mut, drivers) {
            if (mut.startsWith("gain") || mut.startsWith("loss") || mut.startsWith("homdel") || mut === "WGD") {
              return null
            }
            return drivers.includes(mut)
          };

          dl_link += columns.join("\t") + "\n";
          for (let c in cluster_dict) {
            let cluster_row = [c, null, null, null, null, ...aliases.map(
              (_, i) => cluster_dict[c].ccf_hat[i]
                + " (" + cluster_dict[c].ccf_low[i]
                + "-" + cluster_dict[c].ccf_high[i] + ")")];
            dl_link += cluster_row.join("\t") + "\n";
            let cluster_muts = cluster_dict[c].muts,
              drivers = cluster_dict[c].drivers,
              mut_rows = Object.keys(cluster_muts).map(
                d => [c, d, is_driver(d, drivers), cluster_muts[d].chrom, cluster_muts[d].pos,
                  ...aliases.map((_, i) => cluster_muts[d].ccf_hat[i] + " ("
                    + cluster_muts[d].alt_cnt[i] + ":"
                    + cluster_muts[d].ref_cnt[i] + ")"
                  )
                ].join("\t")
              );
            dl_link += mut_rows.join("\n") + "\n"
          }

          let dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "Example_ND" + ".cluster_table.tsv");
          dl.click();

        }

      });

      $("#cluster-table").cluster_table({"cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [0.98, 1.0, 0.92, 0.97], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"], "chrom": "chr1", "pos": "203116592"}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"], "chrom": "chr6", "pos": "54069115"}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"], "chrom": "chr6", "pos": "31180141"}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"], "chrom": "chr16", "pos": "12137783"}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"], "chrom": "chr4", "pos": "12358155"}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"], "chrom": "chr5", "pos": "39128627"}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"], "chrom": "chr6", "pos": "1417608"}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"], "chrom": "chr10", "pos": "44150814"}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"], "chrom": "chr14", "pos": "41194468"}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"], "chrom": "chr1", "pos": "83112457"}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"], "chrom": "chr7", "pos": "125483252"}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"], "chrom": "chr1", "pos": "132144794"}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"], "chrom": "chr6", "pos": "74165244"}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"], "chrom": "chr8", "pos": "23624864"}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"], "chrom": "chr11", "pos": "71847859"}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"], "chrom": "chr10", "pos": "2401524"}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"], "chrom": "chr2", "pos": "155758820"}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"], "chrom": "chr1", "pos": "216025272"}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"], "chrom": "chr9", "pos": "54906067"}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"], "chrom": "chr16", "pos": "4448042"}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"], "chrom": "chr11", "pos": "42572643"}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"], "chrom": "chr8", "pos": "68794502"}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"], "chrom": "chr2", "pos": "221118783"}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"], "chrom": "chr16", "pos": "60609731"}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"], "chrom": "chr11", "pos": "132617216"}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"], "chrom": "chr2", "pos": "134658375"}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"], "chrom": "chr11", "pos": "85707387"}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"], "chrom": "chr4", "pos": "37112458"}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"], "chrom": "chr20", "pos": "49921552"}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"], "chrom": "chr10", "pos": "86906761"}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"], "chrom": "chr12", "pos": "85192368"}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"], "chrom": "chr1", "pos": "26433505"}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"], "chrom": "chr17", "pos": "77961642"}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"], "chrom": "chr7", "pos": "23190612"}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"], "chrom": "chr18", "pos": "59256965"}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"], "chrom": "chr3", "pos": "7953112"}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"], "chrom": "chr1", "pos": "119718772"}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"], "chrom": "chr12", "pos": "51515436"}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"], "chrom": "chr15", "pos": "51641272"}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"], "chrom": "chr3", "pos": "177467084"}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"], "chrom": "chr2", "pos": "159443742"}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"], "chrom": "chr15", "pos": "9208331"}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"], "chrom": "chr8", "pos": "11016138"}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.96, 0.74, 0.01, 0.28], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"], "chrom": "chr4", "pos": "93217970"}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"], "chrom": "chr9", "pos": "109685447"}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"], "chrom": "chr8", "pos": "85404603"}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"], "chrom": "chr9", "pos": "26310976"}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"], "chrom": "chr12", "pos": "83082752"}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"], "chrom": "chr12", "pos": "59892443"}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"], "chrom": "chr15", "pos": "61601382"}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"], "chrom": "chr3", "pos": "112792751"}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"], "chrom": "chr2", "pos": "1276028"}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"], "chrom": "chr9", "pos": "5488020"}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"], "chrom": "chr2", "pos": "195739636"}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"], "chrom": "chr3", "pos": "4967308"}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"], "chrom": "chr18", "pos": "3791536"}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"], "chrom": "chr13", "pos": "43978569"}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"], "chrom": "chr20", "pos": "34878520"}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"], "chrom": "chr1", "pos": "192607152"}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"], "chrom": "chr1", "pos": "108730876"}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"], "chrom": "chr16", "pos": "83054051"}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"], "chrom": "chr7", "pos": "1739320"}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"], "chrom": "chr11", "pos": "81918530"}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.01, 0.09, 0.75, 0.03], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"], "chrom": "chr11", "pos": "72779563"}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr15", "pos": "74631626"}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"], "chrom": "chr11", "pos": "105419584"}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"], "chrom": "chr13", "pos": "31235332"}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"], "chrom": "chr15", "pos": "100671545"}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"], "chrom": "chr12", "pos": "10181887"}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"], "chrom": "chr8", "pos": "85536002"}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"], "chrom": "chr12", "pos": "89396230"}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"], "chrom": "chr2", "pos": "117890927"}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"], "chrom": "chr11", "pos": "77188078"}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"], "chrom": "chr4", "pos": "113590408"}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"], "chrom": "chr10", "pos": "15280573"}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"], "chrom": "chr9", "pos": "140287925"}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"], "chrom": "chr14", "pos": "83027451"}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"], "chrom": "chr17", "pos": "28217979"}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"], "chrom": "chr5", "pos": "107026837"}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"], "chrom": "chr17", "pos": "76824397"}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"], "chrom": "chr3", "pos": "194338870"}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"], "chrom": "chr5", "pos": "646819"}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"], "chrom": "chr8", "pos": "91541022"}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"], "chrom": "chr19", "pos": "12629303"}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"], "chrom": "chr4", "pos": "62487792"}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"], "chrom": "chr9", "pos": "65899379"}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"], "chrom": "chr6", "pos": "13811516"}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr2", "pos": "141016351"}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"], "chrom": "chr2", "pos": "63180458"}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"], "chrom": "chr3", "pos": "94346303"}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"], "chrom": "chr5", "pos": "18405277"}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"], "chrom": "chr2", "pos": "102011380"}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"], "chrom": "chr4", "pos": "28312378"}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"], "chrom": "chr18", "pos": "60319331"}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"], "chrom": "chr2", "pos": "98710565"}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.01, 0.04, 0.15, 0.66], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"], "chrom": "chr19", "pos": "28003645"}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"], "chrom": "chr10", "pos": "46572730"}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"], "chrom": "chr2", "pos": "187507667"}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"], "chrom": "chr2", "pos": "132632672"}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"], "chrom": "chr10", "pos": "74945835"}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"], "chrom": "chr4", "pos": "89478829"}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"], "chrom": "chr3", "pos": "129183914"}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"], "chrom": "chr19", "pos": "20753137"}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"], "chrom": "chr1", "pos": "155732526"}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"], "chrom": "chr6", "pos": "67586649"}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"], "chrom": "chr16", "pos": "28689827"}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"], "chrom": "chr18", "pos": "43153046"}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr8", "pos": "10234168"}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"], "chrom": "chr2", "pos": "178187360"}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"], "chrom": "chr9", "pos": "103609179"}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"], "chrom": "chr3", "pos": "118852316"}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"], "chrom": "chr12", "pos": "19536936"}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"], "chrom": "chr2", "pos": "154784087"}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"], "chrom": "chr2", "pos": "63896119"}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr15", "pos": "41548137"}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"], "chrom": "chr11", "pos": "134953622"}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"], "chrom": "chr4", "pos": "98907643"}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"], "chrom": "chr19", "pos": "52225547"}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"], "chrom": "chr5", "pos": "64764511"}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"], "chrom": "chr12", "pos": "26863967"}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr1", "pos": "152412016"}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"], "chrom": "chr5", "pos": "49140961"}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"], "chrom": "chr3", "pos": "133235099"}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"], "chrom": "chr3", "pos": "133203137"}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr11", "pos": "39857904"}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"], "chrom": "chr2", "pos": "6236611"}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"], "chrom": "chr7", "pos": "122826971"}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"], "chrom": "chr9", "pos": "132378857"}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"], "chrom": "chr1", "pos": "232770125"}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"], "chrom": "chr3", "pos": "182891000"}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"], "chrom": "chr3", "pos": "3079218"}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr15", "pos": "75412966"}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"], "chrom": "chr10", "pos": "113935377"}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"], "chrom": "chr4", "pos": "42944436"}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr10", "pos": "45446247"}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"], "chrom": "chr1", "pos": "219296486"}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"], "chrom": "chr6", "pos": "138504372"}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"], "chrom": "chr1", "pos": "105180724"}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr21", "pos": "44658727"}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"], "chrom": "chr1", "pos": "7333400"}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"], "chrom": "chr13", "pos": "101288184"}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"], "chrom": "chr18", "pos": "13213393"}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr1", "pos": "189508346"}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"], "chrom": "chr5", "pos": "105791975"}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"], "chrom": "chr19", "pos": "37085998"}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"], "chrom": "chr4", "pos": "13768761"}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"], "chrom": "chr5", "pos": "142128037"}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"], "chrom": "chr4", "pos": "109006791"}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"], "chrom": "chr10", "pos": "125649324"}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr1", "pos": "61872286"}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr11", "pos": "39379914"}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"], "chrom": "chr18", "pos": "37378724"}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"], "chrom": "chr5", "pos": "11911058"}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"], "chrom": "chr8", "pos": "131534148"}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"], "chrom": "chr19", "pos": "43375509"}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"], "chrom": "chr5", "pos": "82474821"}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"], "chrom": "chr17", "pos": "51719439"}}, "line_width": 12}}, "aliases": ["T0", "T1", "T2", "T3"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.mutation_plot", {
        options: {
          xlabels: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], line_width: 0, color: "green", drivers: []}},
          width: 500,
          height: 400,
          margins: {top: 20, right: 30, bottom: 35, left: 40}
        },

        _elements: {
          mutation_plot: undefined
        },

        _create: function() {
          const xlabels = this.options.xlabels,
            cluster_dict = this.options.cluster_dict,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins;

          if (xlabels.length > 1) {
            let x = d3.scaleLinear()
              .domain([0, xlabels.length - 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, 1])
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x).tickValues([...Array(xlabels.length).keys()]).tickFormat(d => xlabels[d]));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let line = d3.line()
              .x(d => x(d.x))
              .y(d => y(d.y));

            let mutation_plot = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .style("max-width", "500px")
              .style("min-width", "300px")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
            mutation_plot.append("g")
              .call(xAxis);
            mutation_plot.append("g")
              .call(yAxis);
            mutation_plot.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Samples");
            mutation_plot.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            mutation_plot.append("text")
              .attr("x", width / 2)
              .attr("y", margins.top / 2)
              .attr("text-anchor", "middle")
              .style("font-size", "14px")
              .style("text-decoration", "underline")
              .text("Mutation plot");

            for (let cluster in cluster_dict) {
              let muts = cluster_dict[cluster].muts,
                color = cluster_dict[cluster].color;
              for (let mut in muts) {
                let ccf_hat = muts[mut].ccf_hat,
                  mutation_data = [];
                for (let sample in ccf_hat) {
                  mutation_data.push({
                    x: sample,
                    y: ccf_hat[sample]
                  });
                }
                mutation_plot.append("path")
                  .datum(mutation_data)
                  .attr("fill", "none")
                  .attr("stroke", color)
                  .attr("stroke-width", 3)
                  .attr("opacity", 0.3)
                  .attr("d", line);
              }
            }

            this._elements.mutation_plot = mutation_plot.node();
          } else {
            let max_bin = 0,
              n_bins;
            for (let c in cluster_dict) {
              for (let mut in cluster_dict[c].muts) {
                max_bin = Math.max(max_bin, ...cluster_dict[c].muts[mut].ccf_dist);
                n_bins = cluster_dict[c].muts[mut].ccf_dist.length
              }
            }
            let x = d3.scaleLinear()
              .domain([0, 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, max_bin]).nice()
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let plot_1d = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .style("max-width", "500px")
              .style("min-width", "300px")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
            plot_1d.append("g")
              .call(xAxis);
            plot_1d.append("g")
              .call(yAxis);
            plot_1d.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            plot_1d.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Probability density");

            let zero_str = Array(n_bins).fill(0).reduce(
              (a, c, i) => a + " " + x((n_bins - i - 1) / (n_bins - 1)).toString() + "," + y(0).toString(), " "
            );

            for (let c in cluster_dict) {
              plot_1d.append("g")
                .selectAll("polygon")
                .data(Object.keys(cluster_dict[c].muts))
                .join("polygon")
                .attr("fill", cluster_dict[c].color)
                .attr("opacity", 0.05)
                .attr("stroke", "none")
                .attr("points", d =>
                  cluster_dict[c].muts[d].ccf_dist.reduce(
                    (a, c, i) => a + " " + x(i / (n_bins - 1)).toString() + "," + y(c).toString(), ""
                  ) + zero_str
                );
            }

            plot_1d.append("text")
              .attr("x", width / 2)
              .attr("y", margins.top / 2)
              .attr("text-anchor", "middle")
              .style("font-size", "14px")
              .style("text-decoration", "underline")
              .text("Mutation plot");

            this._elements.mutation_plot = plot_1d.node()
          }

          this._refresh();

        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.mutation_plot.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.mutation_plot.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "Example_ND" + ".mutation_plot.svg");
          dl.click();
        },

        _destroy: function() {
          this.element.context.innerHTML = ""
        }
      });

      $("#mutation-plot").mutation_plot({"cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [0.98, 1.0, 0.92, 0.97], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"], "chrom": "chr1", "pos": "203116592"}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"], "chrom": "chr6", "pos": "54069115"}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"], "chrom": "chr6", "pos": "31180141"}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"], "chrom": "chr16", "pos": "12137783"}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"], "chrom": "chr4", "pos": "12358155"}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"], "chrom": "chr5", "pos": "39128627"}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"], "chrom": "chr6", "pos": "1417608"}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"], "chrom": "chr10", "pos": "44150814"}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"], "chrom": "chr14", "pos": "41194468"}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"], "chrom": "chr1", "pos": "83112457"}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"], "chrom": "chr7", "pos": "125483252"}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"], "chrom": "chr1", "pos": "132144794"}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"], "chrom": "chr6", "pos": "74165244"}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"], "chrom": "chr8", "pos": "23624864"}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"], "chrom": "chr11", "pos": "71847859"}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"], "chrom": "chr10", "pos": "2401524"}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"], "chrom": "chr2", "pos": "155758820"}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"], "chrom": "chr1", "pos": "216025272"}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"], "chrom": "chr9", "pos": "54906067"}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"], "chrom": "chr16", "pos": "4448042"}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"], "chrom": "chr11", "pos": "42572643"}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"], "chrom": "chr8", "pos": "68794502"}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"], "chrom": "chr2", "pos": "221118783"}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"], "chrom": "chr16", "pos": "60609731"}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"], "chrom": "chr11", "pos": "132617216"}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"], "chrom": "chr2", "pos": "134658375"}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"], "chrom": "chr11", "pos": "85707387"}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"], "chrom": "chr4", "pos": "37112458"}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"], "chrom": "chr20", "pos": "49921552"}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"], "chrom": "chr10", "pos": "86906761"}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"], "chrom": "chr12", "pos": "85192368"}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"], "chrom": "chr1", "pos": "26433505"}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"], "chrom": "chr17", "pos": "77961642"}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"], "chrom": "chr7", "pos": "23190612"}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"], "chrom": "chr18", "pos": "59256965"}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"], "chrom": "chr3", "pos": "7953112"}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"], "chrom": "chr1", "pos": "119718772"}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"], "chrom": "chr12", "pos": "51515436"}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"], "chrom": "chr15", "pos": "51641272"}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"], "chrom": "chr3", "pos": "177467084"}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"], "chrom": "chr2", "pos": "159443742"}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"], "chrom": "chr15", "pos": "9208331"}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"], "chrom": "chr8", "pos": "11016138"}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.96, 0.74, 0.01, 0.28], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"], "chrom": "chr4", "pos": "93217970"}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"], "chrom": "chr9", "pos": "109685447"}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"], "chrom": "chr8", "pos": "85404603"}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"], "chrom": "chr9", "pos": "26310976"}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"], "chrom": "chr12", "pos": "83082752"}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"], "chrom": "chr12", "pos": "59892443"}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"], "chrom": "chr15", "pos": "61601382"}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"], "chrom": "chr3", "pos": "112792751"}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"], "chrom": "chr2", "pos": "1276028"}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"], "chrom": "chr9", "pos": "5488020"}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"], "chrom": "chr2", "pos": "195739636"}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"], "chrom": "chr3", "pos": "4967308"}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"], "chrom": "chr18", "pos": "3791536"}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"], "chrom": "chr13", "pos": "43978569"}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"], "chrom": "chr20", "pos": "34878520"}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"], "chrom": "chr1", "pos": "192607152"}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"], "chrom": "chr1", "pos": "108730876"}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"], "chrom": "chr16", "pos": "83054051"}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"], "chrom": "chr7", "pos": "1739320"}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"], "chrom": "chr11", "pos": "81918530"}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.01, 0.09, 0.75, 0.03], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"], "chrom": "chr11", "pos": "72779563"}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr15", "pos": "74631626"}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"], "chrom": "chr11", "pos": "105419584"}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"], "chrom": "chr13", "pos": "31235332"}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"], "chrom": "chr15", "pos": "100671545"}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"], "chrom": "chr12", "pos": "10181887"}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"], "chrom": "chr8", "pos": "85536002"}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"], "chrom": "chr12", "pos": "89396230"}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"], "chrom": "chr2", "pos": "117890927"}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"], "chrom": "chr11", "pos": "77188078"}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"], "chrom": "chr4", "pos": "113590408"}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"], "chrom": "chr10", "pos": "15280573"}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"], "chrom": "chr9", "pos": "140287925"}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"], "chrom": "chr14", "pos": "83027451"}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"], "chrom": "chr17", "pos": "28217979"}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"], "chrom": "chr5", "pos": "107026837"}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"], "chrom": "chr17", "pos": "76824397"}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"], "chrom": "chr3", "pos": "194338870"}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"], "chrom": "chr5", "pos": "646819"}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"], "chrom": "chr8", "pos": "91541022"}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"], "chrom": "chr19", "pos": "12629303"}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"], "chrom": "chr4", "pos": "62487792"}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"], "chrom": "chr9", "pos": "65899379"}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"], "chrom": "chr6", "pos": "13811516"}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr2", "pos": "141016351"}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"], "chrom": "chr2", "pos": "63180458"}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"], "chrom": "chr3", "pos": "94346303"}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"], "chrom": "chr5", "pos": "18405277"}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"], "chrom": "chr2", "pos": "102011380"}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"], "chrom": "chr4", "pos": "28312378"}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"], "chrom": "chr18", "pos": "60319331"}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"], "chrom": "chr2", "pos": "98710565"}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.01, 0.04, 0.15, 0.66], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"], "chrom": "chr19", "pos": "28003645"}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"], "chrom": "chr10", "pos": "46572730"}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"], "chrom": "chr2", "pos": "187507667"}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"], "chrom": "chr2", "pos": "132632672"}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"], "chrom": "chr10", "pos": "74945835"}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"], "chrom": "chr4", "pos": "89478829"}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"], "chrom": "chr3", "pos": "129183914"}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"], "chrom": "chr19", "pos": "20753137"}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"], "chrom": "chr1", "pos": "155732526"}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"], "chrom": "chr6", "pos": "67586649"}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"], "chrom": "chr16", "pos": "28689827"}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"], "chrom": "chr18", "pos": "43153046"}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr8", "pos": "10234168"}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"], "chrom": "chr2", "pos": "178187360"}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"], "chrom": "chr9", "pos": "103609179"}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"], "chrom": "chr3", "pos": "118852316"}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"], "chrom": "chr12", "pos": "19536936"}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"], "chrom": "chr2", "pos": "154784087"}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"], "chrom": "chr2", "pos": "63896119"}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr15", "pos": "41548137"}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"], "chrom": "chr11", "pos": "134953622"}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"], "chrom": "chr4", "pos": "98907643"}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"], "chrom": "chr19", "pos": "52225547"}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"], "chrom": "chr5", "pos": "64764511"}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"], "chrom": "chr12", "pos": "26863967"}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr1", "pos": "152412016"}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"], "chrom": "chr5", "pos": "49140961"}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"], "chrom": "chr3", "pos": "133235099"}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"], "chrom": "chr3", "pos": "133203137"}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr11", "pos": "39857904"}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"], "chrom": "chr2", "pos": "6236611"}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"], "chrom": "chr7", "pos": "122826971"}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"], "chrom": "chr9", "pos": "132378857"}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"], "chrom": "chr1", "pos": "232770125"}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"], "chrom": "chr3", "pos": "182891000"}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"], "chrom": "chr3", "pos": "3079218"}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr15", "pos": "75412966"}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"], "chrom": "chr10", "pos": "113935377"}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"], "chrom": "chr4", "pos": "42944436"}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr10", "pos": "45446247"}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"], "chrom": "chr1", "pos": "219296486"}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"], "chrom": "chr6", "pos": "138504372"}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"], "chrom": "chr1", "pos": "105180724"}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr21", "pos": "44658727"}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"], "chrom": "chr1", "pos": "7333400"}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"], "chrom": "chr13", "pos": "101288184"}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"], "chrom": "chr18", "pos": "13213393"}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr1", "pos": "189508346"}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"], "chrom": "chr5", "pos": "105791975"}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"], "chrom": "chr19", "pos": "37085998"}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"], "chrom": "chr4", "pos": "13768761"}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"], "chrom": "chr5", "pos": "142128037"}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"], "chrom": "chr4", "pos": "109006791"}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"], "chrom": "chr10", "pos": "125649324"}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr1", "pos": "61872286"}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr11", "pos": "39379914"}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"], "chrom": "chr18", "pos": "37378724"}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"], "chrom": "chr5", "pos": "11911058"}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"], "chrom": "chr8", "pos": "131534148"}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"], "chrom": "chr19", "pos": "43375509"}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"], "chrom": "chr5", "pos": "82474821"}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"], "chrom": "chr17", "pos": "51719439"}}, "line_width": 12}}, "xlabels": ["T0", "T1", "T2", "T3"]})
    })
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.fish_plot", {
        options: {
          xlabels: [],
          time_points: [],
          tumor_sizes: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], line_width: 0, color: "green", drivers: []}},
          child_dict: {},
          timed: true,
          width: 500,
          height: 400,
          margins: {top: 20, right: 30, bottom: 35, left: 40}
        },

        _elements: {
          fish_plot: undefined
        },

        _create: function() {
          let xlabels = this.options.xlabels,
            time_points = this.options.time_points,
            tumor_sizes = Object.assign(...this.options.tumor_sizes.map(t => ({[t[0]]: t[1]}))),
            cluster_dict = this.options.cluster_dict,
            child_dict = this.options.child_dict,
            timed = this.options.timed,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins;

          let x = d3.scaleLinear()
            .domain([Math.min(...time_points), Math.max(...time_points)])
            .range([margins.left, width - margins.right]);

          let y = d3.scaleLinear()
            .domain([0, Math.max(...Object.values(tumor_sizes))]).nice()
            .range([height - margins.bottom, margins.top]);

          let xAxis = timed ?
            g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x)) :
            g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x)).tickValues(time_points).tickFormat(d => xlabels[d]);

          let yAxis = g => g
            .attr("transform", "translate(" + margins.left.toString() + " 0)")
            .call(d3.axisLeft(y));

          let interp1d = function(u, population) {
            let p0, p1, t0, t1;
            if (u < time_points[0]) {
              p0 = population[0];
              p1 = population[1];
              t0 = time_points[0];
              t1 = time_points[1];
            } else {
              let n;
              for (n in time_points) {
                n = parseInt(n);
                if (time_points[n] > u) {
                  break;
                }
              }
              p0 = population[n - 1];
              p1 = population[n];
              t0 = time_points[n - 1];
              t1 = time_points[n];
            }
            let m = (p1 - p0) / (t1 - t0),
              dx = u - t0;
            return p0 + (m * dx)
          };

          let h = [],
            tumor_size_t = Object.keys(tumor_sizes).sort((a, b) => a - b);
          for (let i in tumor_size_t) {
            h.push(tumor_size_t[i] - tumor_size_t[i - 1]);
          }

          let pchip = function(u, population) {
            if (u < tumor_size_t[0] || u > tumor_size_t[tumor_size_t.length - 1]) {
              console.log(u, tumor_size_t[tumor_size_t.length - 1]);
              throw "Input outside interpolation range";
            }
            let n;
            for (n in tumor_size_t) {
              n = parseInt(n);
              if (tumor_size_t[n] > u) {
                break;
              }
            }
            let p0 = population[n - 1],
              p1 = population[n],
              d0 = (p0 - population[n - 2]) / h[n - 1],
              d1 = (p1 - p0) / h[n],
              d2 = (population[n + 1] - p1) / h[n + 1],
              fp0 = n === 1 ? d1 : (h[n - 1] * d0 + h[n] * d1) / (h[n - 1] + h[n]),
              fp1 = n === (tumor_size_t.length - 1) ? d1 : (h[n] * d1 + h[n + 1] * d2) / (h[n] + h[n + 1]);
            let v = (u - tumor_size_t[n - 1]) / (tumor_size_t[n] - tumor_size_t[n - 1]);
            return Math.max(0, (p0 * ((2 * v * v * v) - (3 * v * v) + 1)) +
              (p1 * ((-2 * v * v * v) + (3 * v * v))) +
              (fp0 * ((v * v * v) - (2 * v * v) + v)) +
              (fp1 * ((v * v * v) - (v * v))))
          };

          let getOrder = function(cluster, level) {
            cluster = cluster || child_dict[null][0];
            level = level || 1;
            let order = [cluster],
              breaks = {},
              children = child_dict[cluster];
            for (let i in children) {
              let {order: child_order, breaks: child_breaks, level: child_level} = getOrder(children[i], level + 1);
              order = [...order, ...child_order];
              breaks[children[i]] = children.length > 1 ? child_level : false;
              breaks = Object.assign({}, breaks, child_breaks);
            }
            return {order: order, breaks: breaks, level: level}
          };

          let {order, breaks} = getOrder(),
            max_break = Math.max(...Object.values(breaks));

          let fish_plot = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("viewBox", "0 0 " + width + " " + height)
            .style("max-width", "500px")
            .style("min-width", "300px")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
          fish_plot.append("g")
            .call(xAxis);
          fish_plot.append("g")
            .call(yAxis);
          fish_plot.append("text")
            .attr("x", (width + margins.left - margins.right) / 2)
            .attr("y", height - 5)
            .style("text-anchor", "middle")
            .attr("font-size", "10px")
            .text("Time");
          fish_plot.append("text")
            .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
            .attr("x", 10)
            .attr("y", (height + margins.top - margins.bottom) / 2)
            .style("text-anchor", "middle")
            .attr("font-size", "10px")
            .text("Relative size");
          fish_plot.append("text")
            .attr("x", width / 2)
            .attr("y", margins.top / 2)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .style("text-decoration", "underline")
            .text("Tumor abundance plot");

          let t0 = time_points[0],
            linspace = [t0],
            step = (time_points[time_points.length - 1] - t0) / 100;
          for (let i = 1; i < 101; i++) {
            linspace.push(i * step + t0);
          }

          let abundance_stack = Array(101).fill(0);

          for (let o in order) {
            let cluster = order[order.length - o - 1],
              unique_population = child_dict[cluster].reduce(
                (a, c) => a.map((d, i) => d - cluster_dict[c].tumor_abundance[i]), cluster_dict[cluster].tumor_abundance
              ),
              base = [],
              head = [],
              interp_pop = tumor_size_t.map(u => interp1d(u, unique_population) * tumor_sizes[u]);
            for (let i in linspace) {
              base.push(x(linspace[i]) + "," + y(abundance_stack[i]));
              abundance_stack[i] += pchip(linspace[i], interp_pop);
              head.push(x(linspace[i]) + "," + y(abundance_stack[i]));
            }
            fish_plot.append("path")
              .datum(linspace)
              .attr("stroke", cluster_dict[cluster].color)
              .attr("stroke-width", breaks[cluster] ? (max_break - breaks[cluster]) * 2 + 1 : 0)
              .attr("stroke-dasharray", 4)
              .attr("fill", "none")
              .attr("opacity", 1.0)
              .attr("d", d3.line()
                .x(d => x(d))
                .y((d, i) => y(abundance_stack[i])));

            fish_plot.append("polygon")
              .attr("points", head.join(" ") + " " + base.reverse().join(" "))
              .attr("fill", cluster_dict[cluster].color)
              .attr("opacity", 0.5)
              .attr("stroke", "none");
          }
          fish_plot.append("g")
            .selectAll("line")
            .data(time_points)
            .join("line")
            .attr("x1", d => x(d))
            .attr("y1", y.range()[0])
            .attr("x2", d => x(d))
            .attr("y2", y.range()["length"] + margins.top)
            .attr("stroke", "black")
            .attr("stroke-width", 1)
            .attr("stroke-dasharray", "1 4");

          this._elements.fish_plot = fish_plot.node();

          this._refresh();

          d3.select(this.element.context.parentElement).append("button")
            .attr("onclick", "$(\"#fish-plot\").fish_plot(\"download\")")
            .attr("style", "font-size: 12px;")
            .html("Download as SVG")

        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.fish_plot.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.fish_plot.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "Example_ND" + ".tumor_abundance_plot.svg");
          dl.click();
        },

        _destroy: function() {
          this.element.context.innerHTML = "";
          let parent = this.element.context.parentElement;
          parent.removeChild(parent.getElementsByTagName("button")[0])
        }
      });

      let fish_options = {"tumor_sizes": [[0.0, 1.0], [1.0, 1.0], [2.0, 1.0], [3.0, 1.0]], "xlabels": ["T0", "T1", "T2", "T3"], "child_dict": {"1": [2, 3, 4], "2": [], "3": [], "4": [], "null": [1]}, "time_points": [0.0, 1.0, 2.0, 3.0], "cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [0.98, 1.0, 0.92, 0.97], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"], "chrom": "chr1", "pos": "203116592"}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"], "chrom": "chr6", "pos": "54069115"}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"], "chrom": "chr6", "pos": "31180141"}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"], "chrom": "chr16", "pos": "12137783"}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"], "chrom": "chr4", "pos": "12358155"}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"], "chrom": "chr5", "pos": "39128627"}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"], "chrom": "chr6", "pos": "1417608"}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"], "chrom": "chr10", "pos": "44150814"}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"], "chrom": "chr14", "pos": "41194468"}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"], "chrom": "chr1", "pos": "83112457"}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"], "chrom": "chr7", "pos": "125483252"}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"], "chrom": "chr1", "pos": "132144794"}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"], "chrom": "chr6", "pos": "74165244"}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"], "chrom": "chr8", "pos": "23624864"}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"], "chrom": "chr11", "pos": "71847859"}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"], "chrom": "chr10", "pos": "2401524"}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"], "chrom": "chr2", "pos": "155758820"}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"], "chrom": "chr1", "pos": "216025272"}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"], "chrom": "chr9", "pos": "54906067"}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"], "chrom": "chr16", "pos": "4448042"}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"], "chrom": "chr11", "pos": "42572643"}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"], "chrom": "chr8", "pos": "68794502"}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"], "chrom": "chr2", "pos": "221118783"}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"], "chrom": "chr16", "pos": "60609731"}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"], "chrom": "chr11", "pos": "132617216"}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"], "chrom": "chr2", "pos": "134658375"}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"], "chrom": "chr11", "pos": "85707387"}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"], "chrom": "chr4", "pos": "37112458"}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"], "chrom": "chr20", "pos": "49921552"}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"], "chrom": "chr10", "pos": "86906761"}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"], "chrom": "chr12", "pos": "85192368"}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"], "chrom": "chr1", "pos": "26433505"}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"], "chrom": "chr17", "pos": "77961642"}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"], "chrom": "chr7", "pos": "23190612"}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"], "chrom": "chr18", "pos": "59256965"}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"], "chrom": "chr3", "pos": "7953112"}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"], "chrom": "chr1", "pos": "119718772"}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"], "chrom": "chr12", "pos": "51515436"}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"], "chrom": "chr15", "pos": "51641272"}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"], "chrom": "chr3", "pos": "177467084"}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"], "chrom": "chr2", "pos": "159443742"}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"], "chrom": "chr15", "pos": "9208331"}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"], "chrom": "chr8", "pos": "11016138"}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.96, 0.74, 0.01, 0.28], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"], "chrom": "chr4", "pos": "93217970"}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"], "chrom": "chr9", "pos": "109685447"}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"], "chrom": "chr8", "pos": "85404603"}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"], "chrom": "chr9", "pos": "26310976"}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"], "chrom": "chr12", "pos": "83082752"}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"], "chrom": "chr12", "pos": "59892443"}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"], "chrom": "chr15", "pos": "61601382"}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"], "chrom": "chr3", "pos": "112792751"}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"], "chrom": "chr2", "pos": "1276028"}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"], "chrom": "chr9", "pos": "5488020"}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"], "chrom": "chr2", "pos": "195739636"}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"], "chrom": "chr3", "pos": "4967308"}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"], "chrom": "chr18", "pos": "3791536"}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"], "chrom": "chr13", "pos": "43978569"}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"], "chrom": "chr20", "pos": "34878520"}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"], "chrom": "chr1", "pos": "192607152"}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"], "chrom": "chr1", "pos": "108730876"}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"], "chrom": "chr16", "pos": "83054051"}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"], "chrom": "chr7", "pos": "1739320"}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"], "chrom": "chr11", "pos": "81918530"}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.01, 0.09, 0.75, 0.03], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"], "chrom": "chr11", "pos": "72779563"}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr15", "pos": "74631626"}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"], "chrom": "chr11", "pos": "105419584"}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"], "chrom": "chr13", "pos": "31235332"}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"], "chrom": "chr15", "pos": "100671545"}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"], "chrom": "chr12", "pos": "10181887"}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"], "chrom": "chr8", "pos": "85536002"}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"], "chrom": "chr12", "pos": "89396230"}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"], "chrom": "chr2", "pos": "117890927"}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"], "chrom": "chr11", "pos": "77188078"}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"], "chrom": "chr4", "pos": "113590408"}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"], "chrom": "chr10", "pos": "15280573"}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"], "chrom": "chr9", "pos": "140287925"}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"], "chrom": "chr14", "pos": "83027451"}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"], "chrom": "chr17", "pos": "28217979"}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"], "chrom": "chr5", "pos": "107026837"}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"], "chrom": "chr17", "pos": "76824397"}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"], "chrom": "chr3", "pos": "194338870"}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"], "chrom": "chr5", "pos": "646819"}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"], "chrom": "chr8", "pos": "91541022"}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"], "chrom": "chr19", "pos": "12629303"}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"], "chrom": "chr4", "pos": "62487792"}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"], "chrom": "chr9", "pos": "65899379"}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"], "chrom": "chr6", "pos": "13811516"}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"], "chrom": "chr2", "pos": "141016351"}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"], "chrom": "chr2", "pos": "63180458"}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"], "chrom": "chr3", "pos": "94346303"}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"], "chrom": "chr5", "pos": "18405277"}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"], "chrom": "chr2", "pos": "102011380"}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"], "chrom": "chr4", "pos": "28312378"}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"], "chrom": "chr18", "pos": "60319331"}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"], "chrom": "chr2", "pos": "98710565"}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.01, 0.04, 0.15, 0.66], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"], "chrom": "chr19", "pos": "28003645"}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"], "chrom": "chr10", "pos": "46572730"}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"], "chrom": "chr2", "pos": "187507667"}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"], "chrom": "chr2", "pos": "132632672"}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"], "chrom": "chr10", "pos": "74945835"}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"], "chrom": "chr4", "pos": "89478829"}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"], "chrom": "chr3", "pos": "129183914"}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"], "chrom": "chr19", "pos": "20753137"}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"], "chrom": "chr1", "pos": "155732526"}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"], "chrom": "chr6", "pos": "67586649"}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"], "chrom": "chr16", "pos": "28689827"}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"], "chrom": "chr18", "pos": "43153046"}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr8", "pos": "10234168"}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"], "chrom": "chr2", "pos": "178187360"}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"], "chrom": "chr9", "pos": "103609179"}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"], "chrom": "chr3", "pos": "118852316"}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"], "chrom": "chr12", "pos": "19536936"}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"], "chrom": "chr2", "pos": "154784087"}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"], "chrom": "chr2", "pos": "63896119"}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr15", "pos": "41548137"}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"], "chrom": "chr11", "pos": "134953622"}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"], "chrom": "chr4", "pos": "98907643"}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"], "chrom": "chr19", "pos": "52225547"}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"], "chrom": "chr5", "pos": "64764511"}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"], "chrom": "chr12", "pos": "26863967"}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr1", "pos": "152412016"}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"], "chrom": "chr5", "pos": "49140961"}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"], "chrom": "chr3", "pos": "133235099"}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"], "chrom": "chr3", "pos": "133203137"}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr11", "pos": "39857904"}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"], "chrom": "chr2", "pos": "6236611"}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"], "chrom": "chr7", "pos": "122826971"}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"], "chrom": "chr9", "pos": "132378857"}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"], "chrom": "chr1", "pos": "232770125"}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"], "chrom": "chr3", "pos": "182891000"}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"], "chrom": "chr3", "pos": "3079218"}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr15", "pos": "75412966"}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"], "chrom": "chr10", "pos": "113935377"}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"], "chrom": "chr4", "pos": "42944436"}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"], "chrom": "chr10", "pos": "45446247"}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"], "chrom": "chr1", "pos": "219296486"}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"], "chrom": "chr6", "pos": "138504372"}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"], "chrom": "chr1", "pos": "105180724"}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"], "chrom": "chr21", "pos": "44658727"}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"], "chrom": "chr1", "pos": "7333400"}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"], "chrom": "chr13", "pos": "101288184"}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"], "chrom": "chr18", "pos": "13213393"}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"], "chrom": "chr1", "pos": "189508346"}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"], "chrom": "chr5", "pos": "105791975"}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"], "chrom": "chr19", "pos": "37085998"}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"], "chrom": "chr4", "pos": "13768761"}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"], "chrom": "chr5", "pos": "142128037"}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"], "chrom": "chr4", "pos": "109006791"}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"], "chrom": "chr10", "pos": "125649324"}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"], "chrom": "chr1", "pos": "61872286"}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"], "chrom": "chr11", "pos": "39379914"}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"], "chrom": "chr18", "pos": "37378724"}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"], "chrom": "chr5", "pos": "11911058"}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"], "chrom": "chr8", "pos": "131534148"}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"], "chrom": "chr19", "pos": "43375509"}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"], "chrom": "chr5", "pos": "82474821"}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"], "chrom": "chr17", "pos": "51719439"}}, "line_width": 12}}};

      if (fish_options) {
        $("#fish-plot").fish_plot(fish_options)
      }
    })
  </script>
  <style>
    .active-sample:hover {
      background-color: #f0f0f0;
    }

    .removed-sample {
      background-color: gray;
    }

    .active-cluster {
      opacity: 1.0;
    }

    .removed-cluster {
      opacity: 0.2;
    }
  </style>
</head>

<body>
  <main>
    <div class="container-fluid">
      <div class="row">
        <h2 class="ml-3" >Phylogic Results - Example_ND</h2>
      </div>
      <div class="card">
        <div id="headingOne" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Clustering plot/tree
            </button>
          </h5>
        </div>
        <div id="collapseOne" class="collapse show" aria-labelledby="headingOne">
          <div class="card-body">
            <div class="row">
              <div id="sample-name-table" style="max-height: 600px; width: 25%; padding-right: 30px; display: table-cell">
              </div><div class="border-right" style="overflow-y: hidden; width: 45%; padding-right: 30px; display: table-cell">
                <div style="min-width: 450px">
                  <div style="display: inline-block; width: 84%; vertical-align: top">
                    <div id="clustering-plot"></div>
                    <div id="treatment-plot"></div>
                    <button onclick="$('#clustering-plot').clustering_plot('download')" style="font-size: 12px">Download as SVG</button>
                  </div><div style="display: inline-block; width: 16%; vertical-align: top">
                    <div id="time-switch"></div>
                    <div id="cluster-switches" style="overflow-x: hidden"></div>
                  </div>
                </div>
              </div><div style="width: 30%">
                <div id="tree"></div>
                <div id="tree-switch"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingTwo" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
              Clonality chart
            </button>
          </h5>
        </div>
        <div id="collapseTwo" class="collapse show" aria-labelledby="headingTwo">
          <div class="card-body">
            <div class="row">
              <div id="mutation-visual" class="col-md-12 overflow-auto"></div>
              <button onclick="$('#mutation-visual').mutation_visual('download')" style="font-size: 12px">Download as SVG</button>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingThree" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
              Mutation table
            </button>
          </h5>
        </div>
        <div id="collapseThree" class="collapse show" aria-labelledby="headingThree">
          <div class="card-body">
            <div class="row">
              <div id="cluster-table" class="col-md-12 overflow-auto"></div>
            </div>
            <button onclick="$('#cluster-table').cluster_table('download_as_tsv')" style="font-size: 12px">Download as TSV</button>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingFour" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
              Other plots
            </button>
          </h5>
        </div>
        <div id="collapseFour" class="collapse show" aria-labelledby="headingFour">
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 text-center">
                <div id="mutation-plot"></div>
                <button onclick="$('#mutation-plot').mutation_plot('download')" style="font-size: 12px">Download as SVG</button>
              </div>
              <div class="col-md-6 text-center">
                <div id="fish-plot"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row" style="padding-bottom: 50px"></div>
    </div>
  </main>
</body>
</html>